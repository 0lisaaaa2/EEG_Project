/usr/bin/python3.10 /home/lisa/PycharmProjects/EEG_Project/main.py
#######################################################################
start subject 001
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-001/eeg/sub-001_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-001/eeg/sub-001_task-regfront_events.tsv.
Reading 0 ... 183807  =      0.000 ...   358.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-001_task-regfront.

The search_str was "ds005841-download/sub-001/**/eeg/sub-001*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4480 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:08<00:00,    8.44it/s]
2026-01-12 13:18:28,763 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3', 'O1', 'Iz', 'Oz', 'O2'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz'], 'bad_by_manual': [], 'bad_all': ['PO3', 'Iz', 'O2', 'Oz', 'O1']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,   10.12it/s]
2026-01-12 13:18:37,849 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'T8', 'Iz', 'F6', 'FC3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T7', 'T8', 'Iz', 'F6', 'FC3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 13:18:38,120 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,    9.96it/s]
2026-01-12 13:18:46,780 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'T8', 'Iz', 'F6', 'FC3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T7', 'T8', 'Iz', 'F6', 'FC3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 13:18:46,979 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,   10.06it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:18:55,542 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'T8', 'Iz', 'F6', 'FC3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T7', 'T8', 'Iz', 'F6', 'FC3']}
2026-01-12 13:18:55,542 - pyprep.reference - INFO - Robust reference done
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:06<00:00,   10.57it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

4 by correlation: ['FC3', 'T7', 'Iz', 'F6']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:08<00:00,    8.34it/s]

RANSAC done!
Detected bad channels: ['Iz', 'FC3', 'F6', 'T7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.8s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 6 ICA components
    Projecting back using 60 PCA components
Blub ['Iz', 'FC3', 'F6', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['C4']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['Fpz']
    Rejecting  epoch based on EEG : ['Fpz']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.35 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-001/eeg/sub-001_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-001/eeg/sub-001_task-regperp_events.tsv.
Reading 0 ... 216063  =      0.000 ...   421.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-001_task-regperp.

The search_str was "ds005841-download/sub-001/**/eeg/sub-001*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 5312 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 84/84 [00:09<00:00,    8.56it/s]

RANSAC done!
2026-01-12 13:19:45,696 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 84/84 [00:08<00:00,   10.15it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:19:56,304 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F7', 'F6', 'FC3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC3', 'F7', 'F6']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:19:56,639 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 84/84 [00:08<00:00,   10.02it/s]
2026-01-12 13:20:06,845 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['FC3', 'F7', 'F6'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F7', 'F6', 'FC3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:20:07,202 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 84/84 [00:08<00:00,    9.72it/s]
2026-01-12 13:20:17,873 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F7', 'F6', 'FC3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC3', 'F7', 'F6']}
2026-01-12 13:20:17,873 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 84/84 [00:08<00:00,   10.40it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

3 by correlation: ['F7', 'FC3', 'F6']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 84/84 [00:09<00:00,    8.97it/s]

RANSAC done!
Detected bad channels: ['FC3', 'F7', 'F6']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 9.2s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 61 PCA components
Blub ['F7', 'F6', 'FC3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['Iz', 'Oz', 'O2']
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.66 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 001 - Perspective Cost SPN Amplitude: -6.83256371880745e-07
#######################################################################
start subject 002
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-002/eeg/sub-002_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-002/eeg/sub-002_task-regfront_events.tsv.
Reading 0 ... 154623  =      0.000 ...   301.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-002_task-regfront.

The search_str was "ds005841-download/sub-002/**/eeg/sub-002*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3776 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:05<00:00,   10.78it/s]
2026-01-12 13:21:04,296 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['C4'], 'bad_by_correlation': ['C4', 'P4'], 'bad_by_SNR': ['C4'], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['POz', 'C4', 'P4']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:05<00:00,   10.93it/s]
2026-01-12 13:21:11,166 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['C4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P4'], 'bad_by_manual': [], 'bad_all': ['C4', 'P4']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:21:11,312 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:05<00:00,   11.55it/s]
2026-01-12 13:21:17,724 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['C4', 'AF7', 'T7'], 'bad_by_correlation': ['AF7', 'C4'], 'bad_by_SNR': ['C4', 'AF7'], 'bad_by_dropout': [], 'bad_by_ransac': ['P4'], 'bad_by_manual': [], 'bad_all': ['P4', 'AF7', 'C4', 'T7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:21:17,863 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:05<00:00,   10.82it/s]
2026-01-12 13:21:24,676 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'C4', 'T7'], 'bad_by_correlation': ['C4', 'AF7'], 'bad_by_SNR': ['AF7', 'C4'], 'bad_by_dropout': [], 'bad_by_ransac': ['P4'], 'bad_by_manual': [], 'bad_all': ['C4', 'P4', 'AF7', 'T7']}
2026-01-12 13:21:24,677 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:05<00:00,   10.91it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['AF7', 'T7']

1 by correlation: ['AF7']

1 by SNR: ['AF7']

0 by dropout: []

1 by RANSAC: ['C4']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:06<00:00,    9.17it/s]

RANSAC done!
Detected bad channels: ['AF7', 'C4', 'T7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 4.6s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 61 PCA components
Blub ['C4', 'AF7', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.97 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-002/eeg/sub-002_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-002/eeg/sub-002_task-regperp_events.tsv.
Reading 0 ... 199167  =      0.000 ...   388.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-002_task-regperp.

The search_str was "ds005841-download/sub-002/**/eeg/sub-002*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4864 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,   10.71it/s]
2026-01-12 13:22:04,559 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF8', 'C4'], 'bad_by_correlation': ['POz', 'C4'], 'bad_by_SNR': ['C4'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'AF8', 'C4']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:06<00:00,   11.92it/s]
2026-01-12 13:22:12,958 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'C4', 'AF7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF8', 'AF7', 'C4']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:22:13,219 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,   10.69it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:22:21,960 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF8', 'C4'], 'bad_by_correlation': ['AF8', 'F7', 'AF7', 'C4'], 'bad_by_SNR': ['AF8', 'C4'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF8', 'F7', 'AF7', 'C4']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:22:22,165 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,    9.71it/s]
2026-01-12 13:22:31,850 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF8', 'C4'], 'bad_by_correlation': ['AF8', 'F7', 'AF7', 'C4'], 'bad_by_SNR': ['AF8', 'C4'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF8', 'F7', 'AF7', 'C4']}
2026-01-12 13:22:31,850 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,    9.75it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['AF8']

3 by correlation: ['AF7', 'F7', 'AF8']

1 by SNR: ['AF8']

0 by dropout: []

1 by RANSAC: ['C4']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:09<00:00,    8.08it/s]

RANSAC done!
Detected bad channels: ['AF8', 'F7', 'AF7', 'C4']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 8.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 60 PCA components
Blub ['AF8', 'F7', 'AF7', 'C4']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['FC5', 'F6', 'F8', 'FT8', 'FC6', 'T8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.02 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 002 - Perspective Cost SPN Amplitude: -9.537153837226621e-07
#######################################################################
start subject 003
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-003/eeg/sub-003_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-003/eeg/sub-003_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-003_task-regfront.

The search_str was "ds005841-download/sub-003/**/eeg/sub-003*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 197119  =      0.000 ...   384.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4864 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:07<00:00,    9.75it/s]

RANSAC done!
2026-01-12 13:23:19,084 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'POz', 'P2', 'O2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6'], 'bad_by_manual': [], 'bad_all': ['POz', 'C6', 'P2', 'P9', 'O2']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:07<00:00,   10.31it/s]
2026-01-12 13:23:28,783 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'F6', 'C3', 'P2', 'P9', 'O2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC4', 'FT7', 'CP3', 'CP1', 'C5'], 'bad_by_manual': [], 'bad_all': ['F8', 'T8', 'F6', 'C3', 'FC4', 'FT7', 'CP3', 'P2', 'P9', 'O2', 'CP1', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 52 sensor positions
Interpolating 12 sensors
2026-01-12 13:23:29,101 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:07<00:00,    9.88it/s]

RANSAC done!
2026-01-12 13:23:38,633 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'F6', 'C3', 'P2', 'P9', 'O2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6', 'FC4', 'FT7', 'CP3', 'CP1', 'C5'], 'bad_by_manual': [], 'bad_all': ['C6', 'F8', 'T8', 'F6', 'C3', 'FC4', 'FT7', 'CP3', 'P2', 'P9', 'O2', 'CP1', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
2026-01-12 13:23:38,944 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:07<00:00,   10.02it/s]

RANSAC done!
2026-01-12 13:23:48,324 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'F6', 'C3', 'CP3', 'P2', 'P9', 'O2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6', 'FC4', 'FT7', 'C3', 'FC6', 'CP3', 'CP1', 'C5'], 'bad_by_manual': [], 'bad_all': ['C6', 'F8', 'T8', 'F6', 'C3', 'FC4', 'FT7', 'FC6', 'CP3', 'P2', 'P9', 'O2', 'CP1', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
2026-01-12 13:23:48,582 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:07<00:00,   10.51it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:23:57,592 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'F6', 'C3', 'CP3', 'P2', 'P9', 'O2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6', 'FC6', 'FC4', 'FT7', 'C3', 'CP3', 'CP1', 'C5'], 'bad_by_manual': [], 'bad_all': ['C6', 'F8', 'T8', 'F6', 'C3', 'FC6', 'FC4', 'FT7', 'CP3', 'P2', 'P9', 'O2', 'CP1', 'C5']}
2026-01-12 13:23:57,592 - pyprep.reference - INFO - Robust reference done
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:06<00:00,   11.69it/s]

RANSAC done!
Found 11 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

7 by correlation: ['CP3', 'P9', 'F6', 'F8', 'T8', 'P2', 'O2']

0 by SNR: []

0 by dropout: []

4 by RANSAC: ['C5', 'CP1', 'FC6', 'C6']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 76/76 [00:07<00:00,    9.56it/s]

RANSAC done!
Detected bad channels: ['C6', 'F8', 'T8', 'F6', 'FC6', 'CP3', 'P2', 'P9', 'O2', 'CP1', 'C5', 'FT7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 52 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 8.2s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 52 PCA components
Blub ['C6', 'F8', 'T8', 'F6', 'FC6', 'FT7', 'CP3', 'P2', 'P9', 'O2', 'CP1', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 52 sensor positions
Interpolating 12 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['F2']
    Rejecting  epoch based on EEG : ['F7']
    Rejecting  epoch based on EEG : ['F7']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['F7']
    Rejecting  epoch based on EEG : ['F7']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): 0.66 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-003/eeg/sub-003_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-003/eeg/sub-003_task-regperp_events.tsv.
Reading 0 ... 222719  =      0.000 ...   434.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-003_task-regperp.

The search_str was "ds005841-download/sub-003/**/eeg/sub-003*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 5504 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 86/86 [00:08<00:00,   10.08it/s]

RANSAC done!
2026-01-12 13:24:43,599 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP8'], 'bad_by_correlation': ['P9', 'PO3', 'POz', 'AF8', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'AF8', 'PO3', 'P2', 'P9', 'TP8']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 86/86 [00:08<00:00,   10.32it/s]

RANSAC done!
2026-01-12 13:24:54,933 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'F6', 'C3', 'TP8', 'P2', 'P9', 'AF8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'F6', 'TP8', 'C3', 'P2', 'P9', 'AF8', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 13:24:55,299 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 86/86 [00:08<00:00,   10.39it/s]

RANSAC done!
2026-01-12 13:25:05,740 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'T8', 'F6', 'C3', 'P2', 'P9', 'TP8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F4', 'C3', 'FT7'], 'bad_by_manual': [], 'bad_all': ['F4', 'T8', 'F6', 'C3', 'TP8', 'FT7', 'P2', 'P9', 'AF8', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
2026-01-12 13:25:06,250 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 86/86 [00:08<00:00,   10.42it/s]
2026-01-12 13:25:16,818 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'F6', 'C3', 'TP8', 'P2', 'P9', 'AF8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F4', 'FT7', 'C3'], 'bad_by_manual': [], 'bad_all': ['F4', 'T8', 'F6', 'TP8', 'C3', 'FT7', 'P2', 'P9', 'AF8', 'C5']}
2026-01-12 13:25:16,818 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 86/86 [00:08<00:00,   10.41it/s]

RANSAC done!
Found 9 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['AF8']

0 by HF noise: []

7 by correlation: ['C5', 'P9', 'AF8', 'F6', 'T8', 'TP8', 'P2']

0 by SNR: []

0 by dropout: []

2 by RANSAC: ['F4', 'F8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 86/86 [00:10<00:00,    8.54it/s]

RANSAC done!
Detected bad channels: ['F4', 'AF8', 'F8', 'T8', 'F6', 'P2', 'P9', 'TP8', 'C5', 'C3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 54 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 8.4s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 5 ICA components
    Projecting back using 54 PCA components
Blub ['F4', 'F8', 'T8', 'F6', 'TP8', 'C3', 'P2', 'P9', 'AF8', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['AF7']
    Rejecting  epoch based on EEG : ['AF7', 'Fp2', 'AF8']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'Fp2', 'AF8']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['AF7', 'P9', 'Iz', 'Fpz', 'Fp2', 'P10']
    Rejecting  epoch based on EEG : ['AF7']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'F5', 'F7', 'C5', 'P7', 'P9', 'Fp2', 'AF8', 'F2', 'F8', 'TP8', 'P10', 'PO8']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'F7', 'Fpz', 'Fp2', 'AF8', 'AFz', 'F8', 'P10', 'PO8']
    Rejecting  epoch based on EEG : ['Fp2', 'AF8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.97 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 003 - Perspective Cost SPN Amplitude: 1.628042420722482e-06
#######################################################################
start subject 004
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-004/eeg/sub-004_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-004/eeg/sub-004_task-regfront_events.tsv.
Reading 0 ... 193535  =      0.000 ...   377.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-004_task-regfront.

The search_str was "ds005841-download/sub-004/**/eeg/sub-004*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4736 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.80it/s]
2026-01-12 13:26:10,659 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P1', 'POz', 'PO8'], 'bad_by_manual': [], 'bad_all': ['POz', 'P1', 'Fpz', 'PO8']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.78it/s]

RANSAC done!
2026-01-12 13:26:20,318 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F3', 'F7', 'F6', 'FT7', 'C3', 'AF7', 'PO8'], 'bad_by_manual': [], 'bad_all': ['F3', 'F7', 'F6', 'FT7', 'C3', 'Fpz', 'AF7', 'PO8']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 13:26:20,538 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.75it/s]
2026-01-12 13:26:29,874 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'AF7', 'PO8'], 'bad_by_manual': [], 'bad_all': ['F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'Fpz', 'AF7', 'PO8', 'AF8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
2026-01-12 13:26:30,071 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:08<00:00,    9.30it/s]
2026-01-12 13:26:39,806 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F4', 'F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'Fp1', 'AF7', 'PO8', 'P9'], 'bad_by_manual': [], 'bad_all': ['F4', 'F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'Fp1', 'Fpz', 'AF7', 'PO8', 'P9', 'AF8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
2026-01-12 13:26:40,001 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.77it/s]

RANSAC done!
2026-01-12 13:26:49,340 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F4', 'F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'FC6', 'Fp1', 'AF7', 'PO8', 'P9', 'O1'], 'bad_by_manual': [], 'bad_all': ['F4', 'F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'FC6', 'Fp1', 'Fpz', 'AF7', 'PO8', 'P9', 'AF8', 'O1']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 49 sensor positions
Interpolating 15 sensors
2026-01-12 13:26:49,537 - pyprep.reference - INFO - Iterations: 4
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.82it/s]
2026-01-12 13:26:58,809 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F4', 'F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'FC6', 'Fp1', 'AF7', 'PO8', 'P9', 'O1'], 'bad_by_manual': [], 'bad_all': ['F4', 'F3', 'AF4', 'F7', 'F6', 'FT7', 'C3', 'FC6', 'Fp1', 'Fpz', 'AF7', 'PO8', 'P9', 'AF8', 'O1']}
2026-01-12 13:26:58,809 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 49 sensor positions
Interpolating 15 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.82it/s]

RANSAC done!
Found 12 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

2 by correlation: ['Fpz', 'AF8']

0 by SNR: []

0 by dropout: []

10 by RANSAC: ['Fp1', 'F3', 'F7', 'FT7', 'C3', 'O1', 'F4', 'F6', 'FC6', 'PO8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 52 sensor positions
Interpolating 12 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:08<00:00,    8.73it/s]

RANSAC done!
Detected bad channels: ['F4', 'F3', 'F7', 'F6', 'FT7', 'C3', 'FC6', 'Fp1', 'Fpz', 'PO8', 'AF8', 'O1', 'F5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 51 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 6.1s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 0 ICA components
    Projecting back using 51 PCA components
Blub ['F4', 'F3', 'F5', 'F7', 'F6', 'FT7', 'C3', 'FC6', 'Fp1', 'Fpz', 'PO8', 'AF8', 'O1']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7', 'T7']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'F1', 'F5', 'F7', 'FT7', 'FC5', 'T7', 'TP7', 'P9', 'AF8', 'AF4']
    Rejecting  epoch based on EEG : ['P9']
    Rejecting  epoch based on EEG : ['F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['P9']
    Rejecting  epoch based on EEG : ['P9']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'F7', 'FT7', 'T7', 'P9']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7', 'T7', 'P9', 'FT8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['F7', 'FT7']
    Rejecting  epoch based on EEG : ['F7', 'FT7', 'T7']
    Rejecting  epoch based on EEG : ['F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7', 'T7']
    Rejecting  epoch based on EEG : ['F7', 'P9']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7', 'P9']
    Rejecting  epoch based on EEG : ['P9']
    Rejecting  epoch based on EEG : ['F7', 'FT7']
    Rejecting  epoch based on EEG : ['FT7']
    Rejecting  epoch based on EEG : ['P9']
    Rejecting  epoch based on EEG : ['P9']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.55 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-004/eeg/sub-004_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-004/eeg/sub-004_task-regperp_events.tsv.
Reading 0 ... 179711  =      0.000 ...   350.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-004_task-regperp.

The search_str was "ds005841-download/sub-004/**/eeg/sub-004*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4416 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:08<00:00,    8.74it/s]
2026-01-12 13:27:45,759 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp2', 'T8'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'T8']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.93it/s]

RANSAC done!
2026-01-12 13:27:54,591 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'AF8', 'Fp2']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:27:54,740 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.68it/s]

RANSAC done!
2026-01-12 13:28:03,517 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Fp2', 'F6'], 'bad_by_manual': [], 'bad_all': ['F8', 'AF8', 'Fp2', 'F6']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:28:03,662 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.78it/s]
2026-01-12 13:28:12,369 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Fp2', 'F6'], 'bad_by_manual': [], 'bad_all': ['F8', 'AF8', 'Fp2', 'F6']}
2026-01-12 13:28:12,369 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.62it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

2 by correlation: ['AF8', 'F8']

0 by SNR: []

0 by dropout: []

2 by RANSAC: ['C3', 'Fp2']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:08<00:00,    8.72it/s]

RANSAC done!
Detected bad channels: ['F8', 'AF8', 'Fp2', 'C3', 'P9']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.6s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
Blub ['F8', 'C3', 'P9', 'AF8', 'Fp2']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['F4', 'C6', 'T8']
    Rejecting  epoch based on EEG : ['P9', 'T8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['FC5', 'P9', 'Iz']
    Rejecting  epoch based on EEG : ['F3', 'FC5', 'P9', 'Iz', 'F4', 'C6', 'T8']
    Rejecting  epoch based on EEG : ['F3', 'FC5', 'AF4', 'F4', 'C6']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.40 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 004 - Perspective Cost SPN Amplitude: -1.5085441255604316e-07
#######################################################################
start subject 005
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-005/eeg/sub-005_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-005/eeg/sub-005_task-regfront_events.tsv.
Reading 0 ... 181759  =      0.000 ...   354.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-005_task-regfront.

The search_str was "ds005841-download/sub-005/**/eeg/sub-005*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4480 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.63it/s]

RANSAC done!
2026-01-12 13:28:53,108 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz', 'CPz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'CPz']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.80it/s]

RANSAC done!
2026-01-12 13:29:02,054 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fp1', 'C6', 'CPz', 'CP5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'C6', 'CPz', 'CP5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:29:02,211 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.61it/s]
2026-01-12 13:29:11,104 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fp1', 'C6', 'CPz', 'CP5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'C6', 'CPz', 'CP5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:29:11,298 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.64it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:29:20,122 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fp1', 'C6', 'CPz', 'CP5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8', 'FT7'], 'bad_by_manual': [], 'bad_all': ['C6', 'FT7', 'CP5', 'Fp1', 'CPz', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:29:20,308 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.34it/s]

RANSAC done!
2026-01-12 13:29:29,351 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fp1', 'C6', 'CPz', 'CP5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8', 'FT7'], 'bad_by_manual': [], 'bad_all': ['C6', 'FT7', 'CP5', 'Fp1', 'CPz', 'FT8']}
2026-01-12 13:29:29,351 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.63it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

1 by correlation: ['CPz']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['FT7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:08<00:00,    8.12it/s]

RANSAC done!
Detected bad channels: ['CPz', 'FT7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.7s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 62 PCA components
Blub ['CPz', 'FT7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['FT8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['FT8']
    Rejecting  epoch based on EEG : ['C6', 'P8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.92 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-005/eeg/sub-005_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-005/eeg/sub-005_task-regperp_events.tsv.
Reading 0 ... 163839  =      0.000 ...   319.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-005_task-regperp.

The search_str was "ds005841-download/sub-005/**/eeg/sub-005*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.58it/s]
2026-01-12 13:30:09,339 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Iz', 'P10'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P10', 'Iz']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.10it/s]
2026-01-12 13:30:18,783 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
2026-01-12 13:30:18,842 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.49it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:30:26,937 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 13:30:27,048 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.09it/s]

RANSAC done!
2026-01-12 13:30:36,281 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz']}
2026-01-12 13:30:36,281 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.08it/s]

RANSAC done!
Found 0 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
/home/lisa/.local/lib/python3.10/site-packages/pyprep/reference.py:161: RuntimeWarning: No bad channels to interpolate. Doing nothing...
  self.raw.interpolate_bads()
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.10it/s]

RANSAC done!
Detected bad channels: ['FT7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 63 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.5s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 63 PCA components
Blub ['FT7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['Fp1', 'F7', 'FT7', 'P9', 'AFz', 'Fz', 'FT8', 'FC6', 'C6', 'T8']
    Rejecting  epoch based on EEG : ['F7', 'FT7', 'FC5', 'P9', 'FT8', 'FC6', 'C6', 'T8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['FT8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.57 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 005 - Perspective Cost SPN Amplitude: -2.3537373991072105e-06
#######################################################################
start subject 007
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-007/eeg/sub-007_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-007/eeg/sub-007_task-regfront_events.tsv.
Reading 0 ... 202239  =      0.000 ...   394.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-007_task-regfront.

The search_str was "ds005841-download/sub-007/**/eeg/sub-007*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4992 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.23it/s]

RANSAC done!
2026-01-12 13:31:17,680 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P2']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.01it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:31:27,628 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'P10', 'F6', 'FT7', 'P2', 'AF8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF3', 'P10', 'F6', 'FT7', 'P2', 'AF8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:31:27,869 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.26it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:31:37,176 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 13:31:37,375 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.14it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:31:46,756 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC3'], 'bad_by_manual': [], 'bad_all': ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2', 'FC3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
2026-01-12 13:31:46,966 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:06<00:00,   11.16it/s]

RANSAC done!
2026-01-12 13:31:55,631 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC3'], 'bad_by_manual': [], 'bad_all': ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2', 'FC3']}
2026-01-12 13:31:55,631 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.25it/s]

RANSAC done!
Found 8 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

8 by correlation: ['AF3', 'FT7', 'FC5', 'Fp2', 'AF8', 'F6', 'P2', 'P10']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:09<00:00,    8.07it/s]

RANSAC done!
Detected bad channels: ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 56 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 6.5s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 7 ICA components
    Projecting back using 56 PCA components
Blub ['AF3', 'P10', 'F6', 'FT7', 'FC5', 'P2', 'AF8', 'Fp2']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.85 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-007/eeg/sub-007_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-007/eeg/sub-007_task-regperp_events.tsv.
Reading 0 ... 201215  =      0.000 ...   392.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-007_task-regperp.

The search_str was "ds005841-download/sub-007/**/eeg/sub-007*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4928 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.59it/s]

RANSAC done!
2026-01-12 13:32:46,081 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P2']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.53it/s]
2026-01-12 13:32:56,270 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P10']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:32:56,497 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.62it/s]
2026-01-12 13:33:06,281 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P10']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:33:06,447 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.56it/s]
2026-01-12 13:33:16,312 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P10']}
2026-01-12 13:33:16,312 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.57it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

2 by correlation: ['P9', 'P10']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:09<00:00,    8.60it/s]

RANSAC done!
Detected bad channels: ['P9', 'P10']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 62 PCA components
Blub ['P9', 'P10']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['F4']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.37 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 007 - Perspective Cost SPN Amplitude: -4.809766115869135e-07
#######################################################################
start subject 008
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-008/eeg/sub-008_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-008/eeg/sub-008_task-regfront_events.tsv.
Reading 0 ... 162303  =      0.000 ...   316.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-008_task-regfront.

The search_str was "ds005841-download/sub-008/**/eeg/sub-008*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.55it/s]
2026-01-12 13:34:03,507 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FC6'], 'bad_by_correlation': ['FC6'], 'bad_by_SNR': ['FC6'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC6']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.60it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:34:11,856 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['FC6', 'FT7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC6', 'FT7']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:34:12,004 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.62it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:34:20,013 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7'], 'bad_by_correlation': ['FC6', 'FT7'], 'bad_by_SNR': ['FC6', 'FT7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:34:20,152 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.66it/s]
2026-01-12 13:34:28,101 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7'], 'bad_by_correlation': ['FC6', 'FT7'], 'bad_by_SNR': ['FC6', 'FT7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 13:34:28,245 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.59it/s]

RANSAC done!
2026-01-12 13:34:36,223 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7'], 'bad_by_correlation': ['FC6', 'FT7'], 'bad_by_SNR': ['FC6', 'FT7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7']}
2026-01-12 13:34:36,224 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.59it/s]

RANSAC done!
Found 7 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

6 by HF noise: ['AF7', 'F7', 'FT7', 'FC5', 'TP7', 'T8']

1 by correlation: ['FT7']

1 by SNR: ['FT7']

0 by dropout: []

1 by RANSAC: ['FC6']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.09it/s]

RANSAC done!
Detected bad channels: ['TP7', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.2s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 57 PCA components
Blub ['TP7', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'AF7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.32 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-008/eeg/sub-008_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-008/eeg/sub-008_task-regperp_events.tsv.
Reading 0 ... 165887  =      0.000 ...   323.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-008_task-regperp.

The search_str was "ds005841-download/sub-008/**/eeg/sub-008*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.64it/s]
2026-01-12 13:35:19,278 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FC6'], 'bad_by_correlation': ['FC6'], 'bad_by_SNR': ['FC6'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC6']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.86it/s]
2026-01-12 13:35:27,485 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'FC6', 'FT7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'FC6', 'FT7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:35:27,681 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.87it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:35:35,591 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'T8', 'FC6', 'T7'], 'bad_by_correlation': ['P9', 'FC6', 'FT7'], 'bad_by_SNR': ['FC6'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'T8', 'FC6', 'FT7', 'P9']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:35:35,787 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.72it/s]
2026-01-12 13:35:43,850 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'T8', 'FC6', 'T7'], 'bad_by_correlation': ['P9', 'FC6', 'FT7'], 'bad_by_SNR': ['FC6'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'T8', 'FC6', 'FT7', 'P9']}
2026-01-12 13:35:43,850 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.64it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

3 by HF noise: ['T7', 'TP7', 'T8']

2 by correlation: ['FT7', 'P9']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['FC6']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.63it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T7', 'T8', 'FC6', 'FT7', 'P9', 'P10']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.4s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 57 PCA components
Blub ['TP7', 'T7', 'T8', 'P10', 'FC6', 'FT7', 'P9']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.69 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 008 - Perspective Cost SPN Amplitude: -6.351371556268177e-07
#######################################################################
start subject 009
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-009/eeg/sub-009_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-009/eeg/sub-009_task-regfront_events.tsv.
Reading 0 ... 165887  =      0.000 ...   323.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-009_task-regfront.

The search_str was "ds005841-download/sub-009/**/eeg/sub-009*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.63it/s]
2026-01-12 13:36:26,066 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO7', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['O1', 'Iz', 'Oz'], 'bad_by_manual': [], 'bad_all': ['PO3', 'PO7', 'Iz', 'Oz', 'O1']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.73it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:36:34,344 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'Iz', 'C2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'Iz', 'C2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:36:34,515 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.84it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:36:42,467 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'F8', 'Iz', 'C2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'F8', 'Iz', 'C2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:36:42,609 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.55it/s]
2026-01-12 13:36:50,778 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'F8', 'Iz', 'C2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'F8', 'Iz', 'C2']}
2026-01-12 13:36:50,778 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.55it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

2 by correlation: ['TP7', 'F8']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['Iz']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.17it/s]

RANSAC done!
Detected bad channels: ['TP7', 'F8', 'Iz']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.4s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 61 PCA components
Blub ['TP7', 'F8', 'Iz']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['F6']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['O2']
    Rejecting  epoch based on EEG : ['F6']
    Rejecting  epoch based on EEG : ['F6']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.85 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-009/eeg/sub-009_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-009/eeg/sub-009_task-regperp_events.tsv.
Reading 0 ... 185343  =      0.000 ...   361.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-009_task-regperp.

The search_str was "ds005841-download/sub-009/**/eeg/sub-009*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4544 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.43it/s]

RANSAC done!
2026-01-12 13:37:34,704 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['O1', 'Iz', 'Oz'], 'bad_by_correlation': ['CP3', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P1', 'Iz'], 'bad_by_manual': [], 'bad_all': ['PO3', 'Iz', 'CP3', 'P1', 'Oz', 'O1']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.43it/s]
2026-01-12 13:37:44,196 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'CP3', 'Iz', 'AF7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'CP3', 'Iz', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:37:44,370 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,   10.04it/s]
2026-01-12 13:37:53,118 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'Iz', 'CP3', 'AF7', 'P9'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'Iz', 'CP3', 'AF7', 'P9']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 13:37:53,318 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:05<00:00,   13.06it/s]
2026-01-12 13:38:00,408 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'Iz', 'CP3', 'AF7', 'P9', 'P7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'Iz', 'CP3', 'AF7', 'P9', 'P7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:38:00,510 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,   10.07it/s]
2026-01-12 13:38:09,184 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'Iz', 'CP3', 'AF7', 'P9', 'P7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'Iz', 'CP3', 'AF7', 'P9', 'P7']}
2026-01-12 13:38:09,184 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,   10.08it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['AF7']

0 by HF noise: []

5 by correlation: ['AF7', 'TP7', 'CP3', 'P9', 'Iz']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:08<00:00,    8.09it/s]

RANSAC done!
Detected bad channels: ['TP7', 'Iz', 'CP3', 'AF7', 'P9']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 59 PCA components
Blub ['TP7', 'Iz', 'CP3', 'AF7', 'P9']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.06 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 009 - Perspective Cost SPN Amplitude: 1.2092122739259965e-06
#######################################################################
start subject 011
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-011/eeg/sub-011_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-011/eeg/sub-011_task-regfront_events.tsv.
Reading 0 ... 165375  =      0.000 ...   322.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-011_task-regfront.

The search_str was "ds005841-download/sub-011/**/eeg/sub-011*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.64it/s]

RANSAC done!
2026-01-12 13:38:54,666 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'AF7']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.13it/s]

RANSAC done!
2026-01-12 13:39:04,183 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}
2026-01-12 13:39:04,250 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.71it/s]
2026-01-12 13:39:12,310 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': ['POz'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 13:39:12,550 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.06it/s]
2026-01-12 13:39:22,045 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'T7', 'F8', 'F5', 'F7', 'FT7', 'AF7', 'AF8'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': ['POz'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'T7', 'F8', 'F5', 'F7', 'FT7', 'AF7', 'AF8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 13:39:22,237 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.14it/s]

RANSAC done!
2026-01-12 13:39:31,543 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'T7', 'F8', 'F5', 'F7', 'FT7', 'AF7', 'AF8'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': ['POz'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'T7', 'F8', 'F5', 'F7', 'FT7', 'AF7', 'AF8']}
2026-01-12 13:39:31,543 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.13it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

5 by HF noise: ['AF7', 'F7', 'FT7', 'T7', 'AF8']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.13it/s]

RANSAC done!
Detected bad channels: ['T7', 'F7', 'FT7', 'AF7', 'AF8', 'Iz']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 58 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.1s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 58 PCA components
Blub ['T7', 'F7', 'Iz', 'FT7', 'AF7', 'AF8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.11 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-011/eeg/sub-011_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-011/eeg/sub-011_task-regperp_events.tsv.
Reading 0 ... 176639  =      0.000 ...   344.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-011_task-regperp.

The search_str was "ds005841-download/sub-011/**/eeg/sub-011*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4352 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,   10.37it/s]

RANSAC done!
2026-01-12 13:40:10,926 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.67it/s]

RANSAC done!
2026-01-12 13:40:20,546 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}
2026-01-12 13:40:20,611 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.85it/s]
2026-01-12 13:40:29,064 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': ['POz'], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:40:29,245 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.68it/s]
2026-01-12 13:40:38,605 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'T7', 'F7', 'T8', 'FT7', 'AF7'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': ['POz'], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'T7', 'F7', 'T8', 'FT7', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 13:40:38,744 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.62it/s]
2026-01-12 13:40:48,806 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'T7', 'F7', 'T8', 'FT7', 'AF7'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': ['POz'], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'T7', 'F7', 'T8', 'FT7', 'AF7']}
2026-01-12 13:40:48,806 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.54it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

5 by HF noise: ['AF7', 'F7', 'FT7', 'T7', 'T8']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.79it/s]

RANSAC done!
Detected bad channels: ['T7', 'F7', 'T8', 'FT7', 'AF7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.6s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
Blub ['T7', 'F7', 'T8', 'FT7', 'AF7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.75 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 011 - Perspective Cost SPN Amplitude: 1.6349284450076192e-06
#######################################################################
start subject 012
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-012/eeg/sub-012_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-012/eeg/sub-012_task-regfront_events.tsv.
Reading 0 ... 184831  =      0.000 ...   360.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-012_task-regfront.

The search_str was "ds005841-download/sub-012/**/eeg/sub-012*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4544 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:08<00:00,    8.05it/s]

RANSAC done!
2026-01-12 13:41:35,791 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9', 'POz'], 'bad_by_manual': [], 'bad_all': ['P9', 'POz']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.83it/s]
2026-01-12 13:41:45,015 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'CP6', 'C6', 'C4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'CP6', 'C6', 'C4']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:41:45,259 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.76it/s]
2026-01-12 13:41:54,135 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9', 'F8'], 'bad_by_correlation': ['P9', 'CP6', 'C6', 'C4'], 'bad_by_SNR': ['P9'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['C6', 'F8', 'CP6', 'C4', 'P9']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 13:41:54,390 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,   10.16it/s]

RANSAC done!
2026-01-12 13:42:02,944 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9', 'F8'], 'bad_by_correlation': ['P9', 'CP6', 'C6', 'C4'], 'bad_by_SNR': ['P9'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['C6', 'F8', 'CP6', 'C4', 'P9']}
2026-01-12 13:42:02,944 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.86it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['P9', 'F8']

4 by correlation: ['P9', 'C4', 'C6', 'CP6']

1 by SNR: ['P9']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:08<00:00,    8.14it/s]

RANSAC done!
Detected bad channels: ['C6', 'F8', 'CP6', 'C4', 'P9']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 8.6s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
Blub ['C6', 'F8', 'CP6', 'C4', 'P9']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['P9', 'O2']
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.10 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-012/eeg/sub-012_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-012/eeg/sub-012_task-regperp_events.tsv.
Reading 0 ... 189951  =      0.000 ...   370.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-012_task-regperp.

The search_str was "ds005841-download/sub-012/**/eeg/sub-012*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4672 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:08<00:00,    8.54it/s]
2026-01-12 13:42:53,349 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['P9', 'POz']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:07<00:00,    9.65it/s]

RANSAC done!
2026-01-12 13:43:03,014 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['C6'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['CP6'], 'bad_by_manual': [], 'bad_all': ['CP6', 'C6']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:43:03,287 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:07<00:00,    9.68it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:43:12,573 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9', 'F8', 'T7'], 'bad_by_correlation': ['P9', 'C6'], 'bad_by_SNR': ['P9'], 'bad_by_dropout': [], 'bad_by_ransac': ['CP6'], 'bad_by_manual': [], 'bad_all': ['C6', 'T7', 'F8', 'CP6', 'P9']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 13:43:12,756 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:07<00:00,    9.67it/s]

RANSAC done!
2026-01-12 13:43:22,047 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9', 'F8', 'T7'], 'bad_by_correlation': ['P9', 'C6'], 'bad_by_SNR': ['P9'], 'bad_by_dropout': [], 'bad_by_ransac': ['CP6'], 'bad_by_manual': [], 'bad_all': ['C6', 'T7', 'F8', 'CP6', 'P9']}
2026-01-12 13:43:22,047 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:07<00:00,    9.52it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

3 by HF noise: ['T7', 'P9', 'F8']

2 by correlation: ['P9', 'C6']

1 by SNR: ['P9']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:08<00:00,    8.37it/s]

RANSAC done!
Detected bad channels: ['P9', 'F8', 'C6', 'T7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 6.2s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 60 PCA components
Blub ['P9', 'F8', 'C6', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.38 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 012 - Perspective Cost SPN Amplitude: 2.7408546305971047e-07
#######################################################################
start subject 013
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-013/eeg/sub-013_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-013/eeg/sub-013_task-regfront_events.tsv.
Reading 0 ... 162815  =      0.000 ...   317.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-013_task-regfront.

The search_str was "ds005841-download/sub-013/**/eeg/sub-013*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.55it/s]
2026-01-12 13:44:08,348 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'PO8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3', 'PO8']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.57it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:44:16,568 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 13:44:16,703 - pyprep.reference - INFO - Iterations: 1
  0%|          |  : 0/63 [00:00<?,       ?it/s]Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.82it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:44:24,561 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'F7', 'FC5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['AF8', 'F7', 'FC5', 'FT7']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:44:24,744 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.76it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:44:32,614 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'F7', 'FC5', 'AF3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8', 'FT7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'F7', 'FT7', 'FC5', 'AF8', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:44:32,788 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,   10.16it/s]

RANSAC done!
2026-01-12 13:44:40,417 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'F7', 'FC5', 'AF3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8', 'FT7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'F7', 'FT7', 'FC5', 'AF8', 'FT8']}
2026-01-12 13:44:40,417 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.85it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

3 by correlation: ['F7', 'FC5', 'AF8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.66it/s]

RANSAC done!
Detected bad channels: ['AF8', 'F7', 'FC5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.3s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 61 PCA components
Blub ['AF8', 'F7', 'FC5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['PO8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['PO8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.75 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-013/eeg/sub-013_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-013/eeg/sub-013_task-regperp_events.tsv.
Reading 0 ... 166399  =      0.000 ...   324.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-013_task-regperp.

The search_str was "ds005841-download/sub-013/**/eeg/sub-013*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4096 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.62it/s]
2026-01-12 13:45:17,593 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.05it/s]
2026-01-12 13:45:27,234 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
2026-01-12 13:45:27,293 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.63it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:45:35,432 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 13:45:35,590 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:08<00:00,    7.99it/s]

RANSAC done!
2026-01-12 13:45:45,045 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}
2026-01-12 13:45:45,045 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.07it/s]
/home/lisa/.local/lib/python3.10/site-packages/pyprep/reference.py:161: RuntimeWarning: No bad channels to interpolate. Doing nothing...
  self.raw.interpolate_bads()

RANSAC done!
Found 0 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.10it/s]

RANSAC done!
Detected bad channels: []
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 64 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 64 PCA components
Blub []
Setting channel interpolation method to {'eeg': 'spline'}.
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
/home/lisa/PycharmProjects/EEG_Project/s_06_interpolation.py:14: RuntimeWarning: No bad channels to interpolate. Doing nothing...
  raw_interp.interpolate_bads(reset_bads=True)
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['PO8']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'AF3', 'F3', 'F5', 'FC5', 'Fpz', 'Fp2', 'AF8', 'AF4', 'F4', 'FT8', 'FC6', 'C6']
    Rejecting  epoch based on EEG : ['PO8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['PO8']
    Rejecting  epoch based on EEG : ['Fpz']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.13 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 013 - Perspective Cost SPN Amplitude: 1.3789044704405657e-06
#######################################################################
start subject 015
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-015/eeg/sub-015_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-015/eeg/sub-015_task-regfront_events.tsv.
Reading 0 ... 179199  =      0.000 ...   349.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-015_task-regfront.

The search_str was "ds005841-download/sub-015/**/eeg/sub-015*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4416 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:06<00:00,    9.92it/s]

RANSAC done!
2026-01-12 13:46:26,660 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'AF3', 'F3', 'F5', 'F7', 'P7', 'AF8', 'F6'], 'bad_by_correlation': ['P7', 'P2', 'P10'], 'bad_by_SNR': ['P7'], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['POz', 'F3', 'AF3', 'F5', 'F7', 'P10', 'F6', 'Fp1', 'AF7', 'P2', 'AF8', 'P7']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:06<00:00,   10.34it/s]
2026-01-12 13:46:35,203 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['P10'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'P10', 'P2', 'AF8', 'P7', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF3', 'P10', 'P2', 'AF8', 'P7', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:46:35,373 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:06<00:00,   10.01it/s]
2026-01-12 13:46:43,817 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['P10'], 'bad_by_hf_noise': ['F3', 'AF3', 'F5', 'Fp1', 'AF7', 'AF8', 'P7'], 'bad_by_correlation': ['AF3', 'P10', 'P2', 'AF8', 'P7', 'C5'], 'bad_by_SNR': ['AF8', 'P7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF3', 'F3', 'F5', 'P10', 'Fp1', 'AF7', 'P2', 'AF8', 'P7', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
2026-01-12 13:46:43,982 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:06<00:00,    9.98it/s]

RANSAC done!
2026-01-12 13:46:52,443 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['P10'], 'bad_by_hf_noise': ['AF3', 'F3', 'F5', 'Fp1', 'AF7', 'AF8', 'P7'], 'bad_by_correlation': ['AF3', 'P10', 'P2', 'AF8', 'P7', 'C5'], 'bad_by_SNR': ['AF8', 'P7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F3', 'AF3', 'F5', 'P10', 'Fp1', 'AF7', 'P2', 'AF8', 'P7', 'C5']}
2026-01-12 13:46:52,444 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.75it/s]

RANSAC done!
Found 10 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['P10']

6 by HF noise: ['Fp1', 'AF7', 'AF3', 'F3', 'F5', 'AF8']

4 by correlation: ['C5', 'AF8', 'P2', 'P10']

1 by SNR: ['AF8']

0 by dropout: []

1 by RANSAC: ['P7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:08<00:00,    8.08it/s]

RANSAC done!
Detected bad channels: ['AF3', 'F3', 'F5', 'P10', 'Fp1', 'AF7', 'P2', 'AF8', 'P7', 'C5', 'F6']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 53 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.8s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 53 PCA components
Blub ['F3', 'AF3', 'F5', 'P10', 'F6', 'Fp1', 'AF7', 'P2', 'AF8', 'P7', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.87 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-015/eeg/sub-015_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-015/eeg/sub-015_task-regperp_events.tsv.
Reading 0 ... 199679  =      0.000 ...   389.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-015_task-regperp.

The search_str was "ds005841-download/sub-015/**/eeg/sub-015*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4928 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,   10.02it/s]
2026-01-12 13:47:34,300 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'AF3', 'F3', 'F5', 'F7', 'P7', 'AF8', 'FT8', 'C6'], 'bad_by_correlation': ['C5', 'TP7', 'P7', 'P2', 'P10'], 'bad_by_SNR': ['P7'], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'POz', 'C6', 'F3', 'AF3', 'F5', 'F7', 'P10', 'AF7', 'P2', 'AF8', 'P7', 'FT8', 'C5']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,   10.09it/s]

RANSAC done!
2026-01-12 13:47:44,134 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['P10'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'C6', 'P10', 'P7', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'C6', 'P10', 'P7', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 13:47:44,437 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,    9.79it/s]
2026-01-12 13:47:54,128 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['P10'], 'bad_by_hf_noise': ['C6', 'F3', 'AF3', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'P7', 'FT8'], 'bad_by_correlation': ['TP7', 'C6', 'P10', 'P7', 'C5'], 'bad_by_SNR': ['P7'], 'bad_by_dropout': [], 'bad_by_ransac': ['F5'], 'bad_by_manual': [], 'bad_all': ['TP7', 'C6', 'AF3', 'F3', 'F5', 'P10', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'P7', 'FT8', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
2026-01-12 13:47:54,371 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:07<00:00,    9.83it/s]

RANSAC done!
2026-01-12 13:48:03,971 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['P10'], 'bad_by_hf_noise': ['C6', 'AF3', 'F3', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'P7', 'FT8'], 'bad_by_correlation': ['TP7', 'C6', 'P10', 'P7', 'C5'], 'bad_by_SNR': ['P7'], 'bad_by_dropout': [], 'bad_by_ransac': ['F5'], 'bad_by_manual': [], 'bad_all': ['TP7', 'C6', 'F3', 'AF3', 'F5', 'P10', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'P7', 'FT8', 'C5']}
2026-01-12 13:48:03,971 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:08<00:00,    9.61it/s]

RANSAC done!
Found 13 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['P10']

10 by HF noise: ['Fp1', 'AF7', 'AF3', 'F3', 'F5', 'F7', 'AF8', 'F6', 'FT8', 'C6']

2 by correlation: ['C5', 'P10']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['P7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 77/77 [00:09<00:00,    8.39it/s]

RANSAC done!
Detected bad channels: ['C6', 'AF3', 'F3', 'F5', 'P10', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'P7', 'FT8', 'C5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 51 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 1 ICA component
    Projecting back using 51 PCA components
Blub ['C6', 'F3', 'AF3', 'F5', 'P10', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'P7', 'FT8', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.13 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 015 - Perspective Cost SPN Amplitude: 1.260711608797609e-06
#######################################################################
start subject 014
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-014/eeg/sub-014_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-014/eeg/sub-014_task-regfront_events.tsv.
Reading 0 ... 163327  =      0.000 ...   318.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-014_task-regfront.

The search_str was "ds005841-download/sub-014/**/eeg/sub-014*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.61it/s]

RANSAC done!
2026-01-12 13:48:52,055 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'AF3', 'F3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P1'], 'bad_by_manual': [], 'bad_all': ['PO3', 'F3', 'AF3', 'Fp1', 'P1', 'AF7']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.66it/s]
2026-01-12 13:49:00,956 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
2026-01-12 13:49:01,013 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.64it/s]
2026-01-12 13:49:09,004 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'P1'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P1', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:49:09,201 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.58it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:49:17,957 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'AF3', 'F3', 'F5', 'F7', 'P1', 'Fp1', 'AF7'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'F3', 'AF3', 'F5', 'F7', 'P1', 'Fp1', 'AF7']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
2026-01-12 13:49:18,099 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.65it/s]
2026-01-12 13:49:26,843 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'F3', 'AF3', 'F5', 'F7', 'P1', 'Fp1', 'AF7'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'AF3', 'F3', 'F5', 'F7', 'P1', 'Fp1', 'AF7']}
2026-01-12 13:49:26,843 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.63it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

6 by HF noise: ['Fp1', 'AF7', 'AF3', 'F3', 'F5', 'F7']

0 by correlation: []

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['Fp1']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.63it/s]

RANSAC done!
Detected bad channels: ['AF3', 'F3', 'F5', 'F7', 'Fp1', 'AF7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 58 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.5s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 58 PCA components
Blub ['F3', 'AF3', 'F5', 'F7', 'Fp1', 'AF7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.61 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-014/eeg/sub-014_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-014/eeg/sub-014_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-014_task-regperp.

The search_str was "ds005841-download/sub-014/**/eeg/sub-014*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 165887  =      0.000 ...   323.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.18it/s]
2026-01-12 13:50:11,328 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.17it/s]
2026-01-12 13:50:20,845 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
2026-01-12 13:50:20,902 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.17it/s]
2026-01-12 13:50:30,387 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'P1', 'PO3'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P1', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:50:30,536 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.16it/s]
2026-01-12 13:50:39,900 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'PO3', 'AF3', 'F8', 'AF4', 'P1', 'Fp1', 'AF7'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'AF3', 'F8', 'AF4', 'P1', 'Fp1', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 13:50:40,043 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.14it/s]
2026-01-12 13:50:49,372 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz', 'PO3', 'AF3', 'F8', 'AF4', 'P1', 'Fp1', 'AF7'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'AF3', 'F8', 'AF4', 'P1', 'Fp1', 'AF7']}
2026-01-12 13:50:49,372 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.15it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

5 by HF noise: ['Fp1', 'AF7', 'AF3', 'AF4', 'F8']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.15it/s]

RANSAC done!
Detected bad channels: ['AF3', 'F8', 'AF4', 'Fp1', 'AF7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
Blub ['AF3', 'F8', 'AF4', 'Fp1', 'AF7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.77 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 014 - Perspective Cost SPN Amplitude: -8.398334849395314e-07
#######################################################################
start subject 016
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-016/eeg/sub-016_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-016/eeg/sub-016_task-regfront_events.tsv.
Reading 0 ... 164351  =      0.000 ...   320.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-016_task-regfront.

The search_str was "ds005841-download/sub-016/**/eeg/sub-016*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.60it/s]
2026-01-12 13:51:33,146 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT7', 'PO3', 'O1', 'Iz', 'P10'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3', 'P10', 'Iz', 'FT7', 'O1']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.65it/s]
2026-01-12 13:51:41,462 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 13:51:41,635 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.05it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:51:49,440 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P10', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P10', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:51:49,582 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.60it/s]
2026-01-12 13:51:57,733 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P10', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P10', 'PO3']}
2026-01-12 13:51:57,733 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.09it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['P10']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.16it/s]

RANSAC done!
Detected bad channels: ['P10', 'PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.7s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 62 PCA components
Blub ['P10', 'PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.05 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-016/eeg/sub-016_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-016/eeg/sub-016_task-regperp_events.tsv.
Reading 0 ... 163327  =      0.000 ...   318.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-016_task-regperp.

The search_str was "ds005841-download/sub-016/**/eeg/sub-016*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.66it/s]

RANSAC done!
2026-01-12 13:52:43,307 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT7', 'PO3', 'O1', 'Iz', 'P10'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3', 'P10', 'Iz', 'FT7', 'O1']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.61it/s]
2026-01-12 13:52:51,518 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 13:52:51,744 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.69it/s]
2026-01-12 13:52:59,671 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P10', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P10', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:52:59,817 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.43it/s]
2026-01-12 13:53:07,902 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P10', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P10', 'PO3']}
2026-01-12 13:53:07,902 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.14it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['P10']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.05it/s]

RANSAC done!
Detected bad channels: ['P10', 'PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.4s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 62 PCA components
Blub ['P10', 'PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.09 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 016 - Perspective Cost SPN Amplitude: -9.64305116123129e-07
#######################################################################
start subject 018
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-018/eeg/sub-018_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-018/eeg/sub-018_task-regfront_events.tsv.
Reading 0 ... 178687  =      0.000 ...   348.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-018_task-regfront.

The search_str was "ds005841-download/sub-018/**/eeg/sub-018*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4352 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.63it/s]
2026-01-12 13:53:53,147 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'T7', 'T8'], 'bad_by_correlation': ['P1', 'POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'T7', 'T8', 'Fp1', 'P1', 'AF7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:06<00:00,    9.88it/s]
2026-01-12 13:54:01,913 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fp1', 'P1', 'AF7', 'FT7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'P1', 'AF7', 'FT7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:54:02,136 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.74it/s]
2026-01-12 13:54:10,738 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'T8', 'AF7', 'T7'], 'bad_by_correlation': ['FT7', 'Fp1', 'P1', 'FC5', 'AF7'], 'bad_by_SNR': ['Fp1', 'AF7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T7', 'T8', 'FT7', 'Fp1', 'P1', 'AF7', 'FC5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 13:54:10,858 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.75it/s]

RANSAC done!
2026-01-12 13:54:19,500 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'T8', 'T7'], 'bad_by_correlation': ['FT7', 'Fp1', 'P1', 'AF7', 'FC5'], 'bad_by_SNR': ['Fp1', 'AF7'], 'bad_by_dropout': [], 'bad_by_ransac': ['P1'], 'bad_by_manual': [], 'bad_all': ['T7', 'T8', 'FT7', 'Fp1', 'P1', 'AF7', 'FC5']}
2026-01-12 13:54:19,500 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.82it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

4 by HF noise: ['Fp1', 'AF7', 'T7', 'T8']

4 by correlation: ['Fp1', 'AF7', 'FT7', 'FC5']

2 by SNR: ['Fp1', 'AF7']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:08<00:00,    8.37it/s]

RANSAC done!
Detected bad channels: ['T7', 'T8', 'FT7', 'Fp1', 'AF7', 'FC5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 58 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.1s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 58 PCA components
Blub ['T7', 'T8', 'FT7', 'Fp1', 'AF7', 'FC5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.04 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-018/eeg/sub-018_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-018/eeg/sub-018_task-regperp_events.tsv.
Reading 0 ... 157183  =      0.000 ...   306.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-018_task-regperp.

The search_str was "ds005841-download/sub-018/**/eeg/sub-018*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3840 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.64it/s]
2026-01-12 13:55:02,848 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'T7', 'Iz'], 'bad_by_correlation': ['P1', 'POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'T7', 'Iz', 'P1', 'AF7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.55it/s]
2026-01-12 13:55:10,825 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'AF7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P1', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:55:11,007 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.83it/s]
2026-01-12 13:55:18,589 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7'], 'bad_by_correlation': ['FC5', 'P1', 'AF7', 'FT7'], 'bad_by_SNR': ['AF7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC5', 'P1', 'AF7', 'FT7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 13:55:18,790 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.91it/s]

RANSAC done!
2026-01-12 13:55:26,341 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7'], 'bad_by_correlation': ['P1', 'AF7', 'FC5', 'FT7'], 'bad_by_SNR': ['AF7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FC5', 'P1', 'AF7', 'FT7']}
2026-01-12 13:55:26,341 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.87it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['AF7']

3 by correlation: ['AF7', 'FT7', 'FC5']

1 by SNR: ['AF7']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:07<00:00,    8.12it/s]

RANSAC done!
Detected bad channels: ['AF7', 'FC5', 'FT7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 4.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 61 PCA components
Blub ['FC5', 'AF7', 'FT7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.21 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 018 - Perspective Cost SPN Amplitude: -8.214202802285178e-07
#######################################################################
start subject 020
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-020/eeg/sub-020_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-020/eeg/sub-020_task-regfront_events.tsv.
Reading 0 ... 174591  =      0.000 ...   340.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-020_task-regfront.

The search_str was "ds005841-download/sub-020/**/eeg/sub-020*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4288 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.79it/s]
2026-01-12 13:56:07,386 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'T8'], 'bad_by_correlation': ['P1', 'POz', 'P2', 'P4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'POz', 'T8', 'P1', 'P2', 'P4']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.60it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:56:16,197 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'P4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6'], 'bad_by_manual': [], 'bad_all': ['T8', 'C6', 'P4']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:56:16,409 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.59it/s]
2026-01-12 13:56:24,972 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T8'], 'bad_by_correlation': ['T8', 'P4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6'], 'bad_by_manual': [], 'bad_all': ['T8', 'C6', 'P4']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:56:25,152 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.80it/s]
2026-01-12 13:56:33,594 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T8'], 'bad_by_correlation': ['T8', 'P4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6'], 'bad_by_manual': [], 'bad_all': ['T8', 'C6', 'P4']}
2026-01-12 13:56:33,594 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.67it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['T8']

1 by correlation: ['P4']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['F8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:08<00:00,    8.13it/s]

RANSAC done!
Detected bad channels: ['F8', 'T8', 'P4']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 61 PCA components
Blub ['F8', 'T8', 'P4']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.02 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-020/eeg/sub-020_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-020/eeg/sub-020_task-regperp_events.tsv.
Reading 0 ... 174591  =      0.000 ...   340.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-020_task-regperp.

The search_str was "ds005841-download/sub-020/**/eeg/sub-020*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
127 events found on stim channel Status
Event IDs: [5 6 7 8]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
127 events found on stim channel Status
Event IDs: [5 6 7 8]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4288 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.81it/s]
2026-01-12 13:57:17,554 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'PO3', 'POz', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P1', 'PO3', 'P2']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.53it/s]
2026-01-12 13:57:26,433 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 13:57:26,655 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.72it/s]
2026-01-12 13:57:35,155 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'T8', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 13:57:35,343 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.61it/s]

RANSAC done!
2026-01-12 13:57:43,931 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'T8', 'FT8']}
2026-01-12 13:57:43,931 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.64it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

1 by correlation: ['F8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.60it/s]

RANSAC done!
Detected bad channels: ['F8', 'T8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.6s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 5 ICA components
    Projecting back using 62 PCA components
Blub ['F8', 'T8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
127 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 63 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.93 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 020 - Perspective Cost SPN Amplitude: -9.294971364011043e-08
#######################################################################
start subject 021
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-021/eeg/sub-021_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-021/eeg/sub-021_task-regfront_events.tsv.
Reading 0 ... 166399  =      0.000 ...   324.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-021_task-regfront.

The search_str was "ds005841-download/sub-021/**/eeg/sub-021*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4096 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.60it/s]

RANSAC done!
2026-01-12 13:58:22,210 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['TP7', 'P9', 'PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.04it/s]
2026-01-12 13:58:30,256 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F7', 'P9', 'AF8', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:58:30,462 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.81it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:58:38,433 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F7', 'P9', 'AF8', 'Fp2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:58:38,650 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.87it/s]

RANSAC done!
2026-01-12 13:58:46,591 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F7', 'P9', 'AF8', 'Fp2']}
2026-01-12 13:58:46,591 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.55it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

4 by correlation: ['F7', 'T7', 'Fp2', 'AF8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.18it/s]

RANSAC done!
Detected bad channels: ['AF8', 'F7', 'T7', 'Fp2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.2s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 6 ICA components
    Projecting back using 60 PCA components
Blub ['AF8', 'F7', 'Fp2', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.18 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-021/eeg/sub-021_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-021/eeg/sub-021_task-regperp_events.tsv.
Reading 0 ... 158207  =      0.000 ...   308.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-021_task-regperp.

The search_str was "ds005841-download/sub-021/**/eeg/sub-021*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3840 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:07<00:00,    8.16it/s]
2026-01-12 13:59:30,449 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T7', 'TP7'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9', 'POz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'P9', 'POz', 'T7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,   10.02it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 13:59:38,149 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F7', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F7', 'AF7', 'AF8', 'Fp2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:59:38,285 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,   10.02it/s]
2026-01-12 13:59:45,830 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F7', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F7', 'AF7', 'AF8', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 13:59:46,034 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,   10.07it/s]

RANSAC done!
2026-01-12 13:59:53,508 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F7', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F7', 'AF7', 'AF8', 'Fp2']}
2026-01-12 13:59:53,508 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,   10.05it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

5 by correlation: ['AF7', 'F7', 'T7', 'Fp2', 'AF8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:07<00:00,    8.15it/s]

RANSAC done!
Detected bad channels: ['T7', 'F7', 'AF7', 'AF8', 'Fp2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.0s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 7 ICA components
    Projecting back using 59 PCA components
Blub ['T7', 'F7', 'AF7', 'AF8', 'Fp2']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.18 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 021 - Perspective Cost SPN Amplitude: 1.3450705482695034e-09
#######################################################################
start subject 022
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-022/eeg/sub-022_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-022/eeg/sub-022_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-022_task-regfront.

The search_str was "ds005841-download/sub-022/**/eeg/sub-022*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 151039  =      0.000 ...   294.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3712 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 58/58 [00:06<00:00,    9.55it/s]

RANSAC done!
2026-01-12 14:00:29,060 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz', 'PO4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO4']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 58/58 [00:05<00:00,   10.06it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:00:36,353 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'Fpz'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF4', 'AF8', 'PO4', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO4', 'AF4', 'Fpz', 'AF8', 'Fp2', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:00:36,522 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 58/58 [00:05<00:00,   10.46it/s]
2026-01-12 14:00:43,391 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'Fpz'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'AF4', 'PO4', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO4', 'AF4', 'Fpz', 'AF8', 'Fp2', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:00:43,524 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 58/58 [00:05<00:00,   10.11it/s]
2026-01-12 14:00:50,617 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'Fpz'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF4', 'AF8', 'PO4', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO4', 'AF4', 'Fpz', 'AF8', 'Fp2', 'FT8']}
2026-01-12 14:00:50,617 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 58/58 [00:05<00:00,   10.33it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

2 by deviation: ['Fpz', 'Fp2']

0 by HF noise: []

4 by correlation: ['AF8', 'AF4', 'FT8', 'PO4']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 58/58 [00:07<00:00,    8.14it/s]

RANSAC done!
Detected bad channels: ['PO4', 'AF4', 'Fpz', 'AF8', 'Fp2', 'FT8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 58 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.0s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 1 ICA component
    Projecting back using 58 PCA components
Blub ['PO4', 'AF4', 'Fpz', 'AF8', 'Fp2', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['AF7', 'AF3', 'FT7', 'CP5', 'F4', 'F6', 'FT8', 'T8', 'TP8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.52 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-022/eeg/sub-022_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-022/eeg/sub-022_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-022_task-regperp.

The search_str was "ds005841-download/sub-022/**/eeg/sub-022*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 161279  =      0.000 ...   314.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,   10.18it/s]
2026-01-12 14:01:25,612 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz', 'Pz', 'PO4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO4', 'Pz']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.54it/s]
2026-01-12 14:01:33,846 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO4']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:01:33,953 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.61it/s]
2026-01-12 14:01:41,875 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO4']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:01:42,020 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.50it/s]

RANSAC done!
2026-01-12 14:01:49,985 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO4']}
2026-01-12 14:01:49,985 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.59it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

1 by correlation: ['PO4']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['P9']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:07<00:00,    8.14it/s]

RANSAC done!
Detected bad channels: ['P9', 'PO4']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 62 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.3s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 62 PCA components
Blub ['P9', 'PO4']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['FT7', 'AF4', 'T8']
    Rejecting  epoch based on EEG : ['FT7', 'T8', 'P8']
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.54 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 022 - Perspective Cost SPN Amplitude: -9.80090971717731e-07
#######################################################################
start subject 023
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-023/eeg/sub-023_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-023/eeg/sub-023_task-regfront_events.tsv.
Reading 0 ... 164863  =      0.000 ...   321.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-023_task-regfront.

The search_str was "ds005841-download/sub-023/**/eeg/sub-023*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.04it/s]

RANSAC done!
2026-01-12 14:02:31,649 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.66it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:02:40,630 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['C1', 'FC5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['C1', 'FC5']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:02:40,821 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.14it/s]
2026-01-12 14:02:50,109 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['C1', 'FC5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['C1', 'FC5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:02:50,268 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.18it/s]

RANSAC done!
2026-01-12 14:02:59,522 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['C1', 'FC5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['C1', 'FC5']}
2026-01-12 14:02:59,522 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.15it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['CP6']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.17it/s]

RANSAC done!
Detected bad channels: ['CP6']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 63 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 63 PCA components
Blub ['CP6']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['FC5']
    Rejecting  epoch based on EEG : ['FC5']
    Rejecting  epoch based on EEG : ['FC5']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['FT7', 'T7', 'TP7', 'F8', 'FT8', 'FC6', 'FC4', 'C4', 'T8', 'TP8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.43 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-023/eeg/sub-023_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-023/eeg/sub-023_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-023_task-regperp.

The search_str was "ds005841-download/sub-023/**/eeg/sub-023*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 163839  =      0.000 ...   319.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.67it/s]

RANSAC done!
2026-01-12 14:03:38,701 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.15it/s]
2026-01-12 14:03:48,114 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
2026-01-12 14:03:48,176 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.67it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:03:56,188 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:03:56,336 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.13it/s]
2026-01-12 14:04:05,515 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC6'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'FC6']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:04:05,661 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.13it/s]

RANSAC done!
2026-01-12 14:04:14,835 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['POz'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC6'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'FC6']}
2026-01-12 14:04:14,836 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.15it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['FC6']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.19it/s]

RANSAC done!
Detected bad channels: ['FC6']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 63 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.5s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 63 PCA components
Blub ['FC6']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['FT8', 'T8']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['F3', 'F5', 'F7', 'FT7', 'FC3', 'T7', 'TP7', 'T8', 'TP8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.57 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 023 - Perspective Cost SPN Amplitude: -8.638433003310332e-07
#######################################################################
start subject 025
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-025/eeg/sub-025_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-025/eeg/sub-025_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-025_task-regfront.

The search_str was "ds005841-download/sub-025/**/eeg/sub-025*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 170495  =      0.000 ...   332.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4160 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.83it/s]

RANSAC done!
2026-01-12 14:04:59,392 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P1'], 'bad_by_correlation': ['P1', 'P9', 'P10'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P1', 'P10']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.59it/s]
2026-01-12 14:05:07,978 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['P9', 'P1', 'P10']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:05:08,121 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.73it/s]
2026-01-12 14:05:16,362 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P1', 'P10'], 'bad_by_correlation': ['P1', 'P10'], 'bad_by_SNR': ['P1', 'P10'], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['P9', 'P1', 'P10']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:05:16,542 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.79it/s]
2026-01-12 14:05:25,060 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P1', 'P10'], 'bad_by_correlation': ['P1', 'P10'], 'bad_by_SNR': ['P1', 'P10'], 'bad_by_dropout': [], 'bad_by_ransac': ['P9'], 'bad_by_manual': [], 'bad_all': ['P9', 'P1', 'P10']}
2026-01-12 14:05:25,060 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.68it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['P10']

1 by correlation: ['P10']

1 by SNR: ['P10']

0 by dropout: []

1 by RANSAC: ['P9']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:08<00:00,    8.17it/s]

RANSAC done!
Detected bad channels: ['P9', 'P10', 'P1']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.7s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 61 PCA components
Blub ['P9', 'P10', 'P1']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['P8']
    Rejecting  epoch based on EEG : ['Fp1', 'AF7', 'AF3', 'F1', 'F3', 'TP7', 'P7', 'P9', 'Iz', 'Fpz', 'Fp2', 'AF8', 'AF4', 'AFz', 'F4', 'F6', 'P10', 'O2']
    Rejecting  epoch based on EEG : ['Fp2', 'F6']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.31 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-025/eeg/sub-025_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-025/eeg/sub-025_task-regperp_events.tsv.
Reading 0 ... 183807  =      0.000 ...   358.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-025_task-regperp.

The search_str was "ds005841-download/sub-025/**/eeg/sub-025*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4480 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,    9.92it/s]
2026-01-12 14:06:10,261 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P1', 'P9', 'O1'], 'bad_by_correlation': ['P1', 'P9', 'P10'], 'bad_by_SNR': ['P9', 'P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P1', 'P10', 'O1']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,    9.75it/s]
2026-01-12 14:06:19,444 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P1', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P1', 'P10']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:06:19,621 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,    9.86it/s]
2026-01-12 14:06:28,390 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO7', 'T7', 'Iz', 'P1', 'P9', 'P7', 'O1'], 'bad_by_correlation': ['P9', 'P1', 'P10'], 'bad_by_SNR': ['P9', 'P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO7', 'T7', 'P10', 'Iz', 'P1', 'P9', 'P7', 'O1']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 14:06:28,614 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,    9.76it/s]
2026-01-12 14:06:37,432 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO7', 'T7', 'Iz', 'P1', 'P9', 'P7', 'O1'], 'bad_by_correlation': ['P9', 'P1', 'P10'], 'bad_by_SNR': ['P9', 'P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO7', 'T7', 'P10', 'Iz', 'P1', 'P9', 'P7', 'O1']}
2026-01-12 14:06:37,433 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:07<00:00,    9.66it/s]

RANSAC done!
Found 7 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

6 by HF noise: ['T7', 'P7', 'P9', 'PO7', 'O1', 'Iz']

2 by correlation: ['P9', 'P10']

1 by SNR: ['P9']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 71/71 [00:08<00:00,    8.63it/s]

RANSAC done!
Detected bad channels: ['PO7', 'T7', 'P10', 'Iz', 'P1', 'P9', 'P7', 'O1']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 56 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.7s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 56 PCA components
Blub ['PO7', 'T7', 'P10', 'Iz', 'P1', 'P9', 'P7', 'O1']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.03 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 025 - Perspective Cost SPN Amplitude: -1.2897284823317717e-06
#######################################################################
start subject 027
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-027/eeg/sub-027_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-027/eeg/sub-027_task-regfront_events.tsv.
Reading 0 ... 172543  =      0.000 ...   336.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-027_task-regfront.

The search_str was "ds005841-download/sub-027/**/eeg/sub-027*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4224 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:06<00:00,   10.61it/s]
2026-01-12 14:07:21,833 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['FT7', 'TP7', 'CP5', 'CP1', 'P1', 'P9', 'PO7', 'O1', 'T8', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['CP3', 'POz', 'C4', 'P2'], 'bad_by_manual': [], 'bad_all': ['TP7', 'POz', 'PO7', 'T8', 'P10', 'FT7', 'CP5', 'P1', 'CP3', 'C4', 'P2', 'P9', 'CP1', 'O1']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:03<00:00,   18.09it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:07:27,290 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F4', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 33 sensor positions
Interpolating 31 sensors
2026-01-12 14:07:27,405 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:03<00:00,   16.97it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:07:32,851 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'FC1', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FCz'], 'bad_by_manual': [], 'bad_all': ['F4', 'FC1', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'FCz', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 31 sensor positions
Interpolating 33 sensors
2026-01-12 14:07:32,964 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:04<00:00,   15.01it/s]
2026-01-12 14:07:38,953 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'FC1', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FCz'], 'bad_by_manual': [], 'bad_all': ['F4', 'FC1', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'FCz', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 30 sensor positions
Interpolating 34 sensors
2026-01-12 14:07:39,071 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:04<00:00,   14.89it/s]
2026-01-12 14:07:45,053 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'FC1', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FCz'], 'bad_by_manual': [], 'bad_all': ['F4', 'FC1', 'C6', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'C1', 'T7', 'FCz', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CPz', 'CP1', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz']}
2026-01-12 14:07:45,053 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 30 sensor positions
Interpolating 34 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:04<00:00,   14.63it/s]

RANSAC done!
Found 26 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

25 by correlation: ['AF7', 'F5', 'F7', 'FT7', 'FC5', 'C1', 'C3', 'C5', 'T7', 'TP7', 'CP5', 'CP3', 'CP1', 'P1', 'P9', 'AF4', 'F6', 'FT8', 'FC6', 'FC2', 'Cz', 'C2', 'C4', 'T8', 'P10']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['F8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 38 sensor positions
Interpolating 26 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:08<00:00,    8.26it/s]

RANSAC done!
Detected bad channels: ['F7', 'P9', 'FT8', 'C5', 'C1', 'T7', 'F8', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'CP1', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz', 'F4', 'FC1', 'F2', 'F1', 'P2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 33 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.3s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 33 PCA components
Blub ['F4', 'FC1', 'F7', 'F1', 'P9', 'FT8', 'C5', 'C1', 'T7', 'F8', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'P2', 'CP1', 'F2', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 33 sensor positions
Interpolating 31 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['T7', 'O1']
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.22 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-027/eeg/sub-027_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-027/eeg/sub-027_task-regperp_events.tsv.
Reading 0 ... 169983  =      0.000 ...   331.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-027_task-regperp.

The search_str was "ds005841-download/sub-027/**/eeg/sub-027*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4160 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,   10.38it/s]
2026-01-12 14:08:25,133 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['FT7', 'TP7', 'P1', 'P9', 'PO7', 'POz', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['CPz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'POz', 'PO7', 'P10', 'FT7', 'P1', 'CPz', 'P9']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:03<00:00,   18.03it/s]
2026-01-12 14:08:30,480 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'F7', 'P9', 'TP8', 'FT8', 'PO4', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CPz', 'CP1', 'PO7', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['F4', 'F7', 'P9', 'TP8', 'FT8', 'PO4', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'Pz', 'CP2', 'TP7', 'POz', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CPz', 'CP1', 'PO7', 'FC6', 'FT7', 'CP3', 'FC5', 'C4', 'Cz']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 32 sensor positions
Interpolating 32 sensors
2026-01-12 14:08:30,600 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:04<00:00,   16.02it/s]
2026-01-12 14:08:36,237 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'PO4', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CPz', 'CP1', 'PO7', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['F4', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'PO4', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'POz', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CPz', 'CP1', 'PO7', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 29 sensor positions
Interpolating 35 sensors
2026-01-12 14:08:36,349 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:04<00:00,   15.15it/s]
2026-01-12 14:08:42,163 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'PO4', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CPz', 'CP1', 'PO7', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['F4', 'F7', 'P9', 'TP8', 'FT8', 'C5', 'PO4', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'FC2', 'Pz', 'CP2', 'TP7', 'POz', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CPz', 'CP1', 'PO7', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz']}
2026-01-12 14:08:42,163 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 29 sensor positions
Interpolating 35 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:04<00:00,   15.09it/s]

RANSAC done!
Found 27 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['AF7']

0 by HF noise: []

25 by correlation: ['Fp1', 'AF7', 'F5', 'F7', 'FT7', 'FC5', 'C1', 'C3', 'C5', 'T7', 'TP7', 'CP5', 'CP3', 'CP1', 'P1', 'P9', 'AF4', 'F6', 'FT8', 'FC6', 'FC4', 'Cz', 'C2', 'C4', 'T8']

0 by SNR: []

0 by dropout: []

2 by RANSAC: ['FC1', 'F4']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 37 sensor positions
Interpolating 27 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.97it/s]

RANSAC done!
Detected bad channels: ['F4', 'FC1', 'F7', 'P9', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'TP7', 'C2', 'F5', 'AF4', 'T8', 'CP5', 'Fp1', 'CP1', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz', 'POz', 'P10']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 35 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.7s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 35 PCA components
Blub ['F4', 'FC1', 'F7', 'P9', 'FT8', 'C5', 'C1', 'T7', 'F6', 'C3', 'P1', 'AF7', 'TP7', 'POz', 'C2', 'F5', 'AF4', 'T8', 'P10', 'CP5', 'Fp1', 'CP1', 'FC6', 'FT7', 'FC4', 'CP3', 'FC5', 'C4', 'Cz']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 35 sensor positions
Interpolating 29 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['F8', 'FT8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.89 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 027 - Perspective Cost SPN Amplitude: 2.6656545912677694e-06
#######################################################################
start subject 028
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-028/eeg/sub-028_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-028/eeg/sub-028_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-028_task-regfront.

The search_str was "ds005841-download/sub-028/**/eeg/sub-028*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 167935  =      0.000 ...   327.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4096 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,   10.08it/s]
2026-01-12 14:09:21,945 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['FT7', 'P1', 'PO3', 'POz', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'FT7', 'P1', 'P8']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:05<00:00,   10.85it/s]
2026-01-12 14:09:29,645 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FT7', 'TP8', 'AF8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['AF7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FT7', 'Fp1', 'AF7', 'AF8', 'TP8', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 52 sensor positions
Interpolating 12 sensors
2026-01-12 14:09:29,757 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:05<00:00,   10.88it/s]
2026-01-12 14:09:37,229 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'T7', 'F8', 'F7', 'T8', 'F6', 'FT7', 'FC6', 'AF8', 'TP8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC5', 'AF7', 'T7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'T7', 'F8', 'F7', 'T8', 'F6', 'FT7', 'FC6', 'TP8', 'Fp1', 'AF7', 'FC5', 'AF8', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 49 sensor positions
Interpolating 15 sensors
2026-01-12 14:09:37,376 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:05<00:00,   11.48it/s]
2026-01-12 14:09:44,503 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'T7', 'F8', 'F7', 'T8', 'F6', 'FT7', 'FC6', 'TP8', 'AF8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['AF7', 'FC5', 'T7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'T7', 'F8', 'F7', 'T8', 'F6', 'FT7', 'FC6', 'Fp1', 'AF7', 'FC5', 'AF8', 'TP8', 'FT8', 'P8']}
2026-01-12 14:09:44,503 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 49 sensor positions
Interpolating 15 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:05<00:00,   10.83it/s]

RANSAC done!
Found 14 uniquely bad channels:

0 by NaN: []

0 by flat: []

2 by deviation: ['Fp1', 'AF7']

0 by HF noise: []

10 by correlation: ['AF3', 'F7', 'FT7', 'T7', 'AF8', 'F8', 'FT8', 'FC6', 'T8', 'P8']

0 by SNR: []

0 by dropout: []

2 by RANSAC: ['FC5', 'F6']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:07<00:00,    8.67it/s]

RANSAC done!
Detected bad channels: ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'F6', 'Fp1', 'AF7', 'FC5', 'AF8', 'FT8', 'P8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 50 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.4s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 50 PCA components
Blub ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'F6', 'Fp1', 'AF7', 'FC5', 'AF8', 'FT8', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['Fpz']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['Fpz']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.49 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-028/eeg/sub-028_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-028/eeg/sub-028_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-028_task-regperp.

The search_str was "ds005841-download/sub-028/**/eeg/sub-028*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 191999  =      0.000 ...   374.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4736 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:07<00:00,    9.78it/s]

RANSAC done!
2026-01-12 14:10:23,110 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['F7', 'T7'], 'bad_by_correlation': ['F7', 'P1', 'PO3', 'POz'], 'bad_by_SNR': ['F7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'T7', 'F7', 'P1']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:06<00:00,   11.00it/s]
2026-01-12 14:10:32,128 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'F7', 'Fpz', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'Fp1', 'Fpz', 'AF7', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 52 sensor positions
Interpolating 12 sensors
2026-01-12 14:10:32,482 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:07<00:00,   10.51it/s]

RANSAC done!
2026-01-12 14:10:41,469 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'F7', 'Fpz', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['T7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'Fp1', 'Fpz', 'AF7', 'FC5', 'FT8', 'P8']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
2026-01-12 14:10:41,852 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:06<00:00,   10.63it/s]
2026-01-12 14:10:50,627 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'F7', 'Fpz', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'FC5', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['T7'], 'bad_by_manual': [], 'bad_all': ['AF3', 'T7', 'F8', 'F7', 'T8', 'FC6', 'FT7', 'Fp1', 'Fpz', 'AF7', 'FC5', 'FT8', 'P8']}
2026-01-12 14:10:50,627 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:06<00:00,   10.67it/s]

RANSAC done!
Found 11 uniquely bad channels:

0 by NaN: []

0 by flat: []

3 by deviation: ['Fp1', 'AF7', 'F7']

0 by HF noise: []

8 by correlation: ['AF3', 'F7', 'FT7', 'FC5', 'F8', 'FT8', 'FC6', 'P8']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['T7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 74/74 [00:08<00:00,    8.48it/s]

RANSAC done!
Detected bad channels: ['AF3', 'T7', 'F8', 'F7', 'FC6', 'FT7', 'Fp1', 'AF7', 'FC5', 'FT8', 'P8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 53 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.0s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 7 ICA components
    Projecting back using 53 PCA components
Blub ['AF3', 'T7', 'F8', 'F7', 'FC6', 'FT7', 'Fp1', 'AF7', 'FC5', 'FT8', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.77 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 028 - Perspective Cost SPN Amplitude: -1.7161643566133682e-06
#######################################################################
start subject 029
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-029/eeg/sub-029_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-029/eeg/sub-029_task-regfront_events.tsv.
Reading 0 ... 188927  =      0.000 ...   368.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-029_task-regfront.

The search_str was "ds005841-download/sub-029/**/eeg/sub-029*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4608 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:07<00:00,    9.46it/s]

RANSAC done!
2026-01-12 14:11:38,241 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7'], 'bad_by_correlation': ['PO3', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'P10', 'PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:07<00:00,    9.48it/s]

RANSAC done!
2026-01-12 14:11:48,297 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P10', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'CP5'], 'bad_by_manual': [], 'bad_all': ['TP7', 'P10', 'CP5', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:11:48,637 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:07<00:00,   10.09it/s]

RANSAC done!
2026-01-12 14:11:57,809 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'P10', 'AF7', 'FC2', 'P9', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'CP5'], 'bad_by_manual': [], 'bad_all': ['TP7', 'P10', 'CP5', 'AF7', 'FC2', 'P9', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:11:58,216 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:07<00:00,   10.10it/s]

RANSAC done!
2026-01-12 14:12:07,203 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'P10', 'FT7', 'AF7', 'FC2', 'P9', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'CP5'], 'bad_by_manual': [], 'bad_all': ['TP7', 'P10', 'FT7', 'CP5', 'AF7', 'FC2', 'P9', 'C5']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 14:12:07,545 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:07<00:00,   10.04it/s]
2026-01-12 14:12:16,648 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'P10', 'FT7', 'AF7', 'FC2', 'P9', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'CP5'], 'bad_by_manual': [], 'bad_all': ['TP7', 'P10', 'FT7', 'CP5', 'AF7', 'FC2', 'P9', 'C5']}
2026-01-12 14:12:16,648 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:07<00:00,   10.14it/s]

RANSAC done!
Found 7 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

6 by correlation: ['FT7', 'C5', 'TP7', 'P9', 'FC2', 'P10']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['T7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 73/73 [00:08<00:00,    8.51it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T7', 'P10', 'FT7', 'FC2', 'P9', 'C5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 8.3s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 57 PCA components
Blub ['TP7', 'T7', 'P10', 'FT7', 'FC2', 'P9', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.55 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-029/eeg/sub-029_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-029/eeg/sub-029_task-regperp_events.tsv.
Reading 0 ... 159231  =      0.000 ...   310.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-029_task-regperp.

The search_str was "ds005841-download/sub-029/**/eeg/sub-029*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3904 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.64it/s]

RANSAC done!
2026-01-12 14:13:03,245 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.81it/s]
2026-01-12 14:13:11,285 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'CP5', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC2'], 'bad_by_manual': [], 'bad_all': ['TP7', 'C5', 'FC2', 'CP5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:13:11,500 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   10.60it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:13:18,745 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'F5', 'FT7', 'CP5', 'AF8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC2'], 'bad_by_manual': [], 'bad_all': ['TP7', 'F5', 'FT7', 'CP5', 'FC2', 'AF8', 'FT8', 'C5']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 14:13:18,921 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,   10.14it/s]
2026-01-12 14:13:26,434 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'F5', 'FT7', 'CP5', 'AF8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC2', 'T7'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F5', 'FT7', 'CP5', 'FC2', 'AF8', 'FT8', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
2026-01-12 14:13:26,585 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,   10.06it/s]
2026-01-12 14:13:34,181 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'F5', 'FT7', 'CP5', 'AF8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC2', 'T7'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F5', 'FT7', 'CP5', 'FC2', 'AF8', 'FT8', 'C5']}
2026-01-12 14:13:34,181 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,   10.17it/s]

RANSAC done!
Found 7 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

5 by correlation: ['FT7', 'C5', 'TP7', 'CP5', 'FT8']

0 by SNR: []

0 by dropout: []

2 by RANSAC: ['T7', 'P9']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.64it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T7', 'FT7', 'CP5', 'P9', 'FT8', 'C5', 'F5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 56 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 7.1s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 5 ICA components
    Projecting back using 56 PCA components
Blub ['TP7', 'T7', 'F5', 'FT7', 'CP5', 'P9', 'FT8', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.76 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 029 - Perspective Cost SPN Amplitude: 2.2088054143676605e-06
#######################################################################
start subject 030
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-030/eeg/sub-030_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-030/eeg/sub-030_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-030_task-regfront.

The search_str was "ds005841-download/sub-030/**/eeg/sub-030*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 167423  =      0.000 ...   326.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4096 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.59it/s]

RANSAC done!
2026-01-12 14:14:16,078 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'PO3', 'Fp2', 'AF8'], 'bad_by_correlation': ['PO3', 'P2'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3', 'Fp1', 'AF7', 'P2', 'AF8', 'Fp2']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,   10.11it/s]

RANSAC done!
2026-01-12 14:14:24,224 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'Fp1', 'Fpz', 'AF7', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C3'], 'bad_by_manual': [], 'bad_all': ['PO3', 'C3', 'Fp1', 'Fpz', 'AF7', 'Fp2']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:14:24,440 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.88it/s]

RANSAC done!
2026-01-12 14:14:32,483 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'Fp1', 'Fpz', 'AF7', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C3'], 'bad_by_manual': [], 'bad_all': ['PO3', 'C3', 'Fp1', 'Fpz', 'AF7', 'Fp2']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:14:32,634 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.88it/s]

RANSAC done!
2026-01-12 14:14:40,697 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'Fp1', 'Fpz', 'AF7', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C3'], 'bad_by_manual': [], 'bad_all': ['PO3', 'C3', 'Fp1', 'Fpz', 'AF7', 'Fp2']}
2026-01-12 14:14:40,697 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.74it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['Fp1']

3 by correlation: ['Fp1', 'AF7', 'Fp2']

1 by SNR: ['Fp1']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:07<00:00,    8.57it/s]

RANSAC done!
Detected bad channels: ['Fp1', 'PO3', 'AF7', 'Fp2', 'C3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.4s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
Blub ['PO3', 'C3', 'Fp1', 'AF7', 'Fp2']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.31 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-030/eeg/sub-030_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-030/eeg/sub-030_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-030_task-regperp.

The search_str was "ds005841-download/sub-030/**/eeg/sub-030*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 165375  =      0.000 ...   322.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.90it/s]

RANSAC done!
2026-01-12 14:15:23,160 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3'], 'bad_by_correlation': ['PO3', 'P2'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'P2']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.82it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:15:31,401 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F4', 'PO3', 'C3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['C6'], 'bad_by_manual': [], 'bad_all': ['F4', 'C6', 'PO3', 'C3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:15:31,590 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.87it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:15:39,500 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3'], 'bad_by_correlation': ['F4', 'PO3', 'C3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['C6'], 'bad_by_manual': [], 'bad_all': ['F4', 'C6', 'PO3', 'C3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:15:39,689 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.92it/s]
2026-01-12 14:15:47,555 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3'], 'bad_by_correlation': ['F4', 'PO3', 'C3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['C6', 'FC3'], 'bad_by_manual': [], 'bad_all': ['F4', 'C6', 'PO3', 'C3', 'FC3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:15:47,765 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.90it/s]
2026-01-12 14:15:55,638 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3'], 'bad_by_correlation': ['F4', 'PO3', 'C3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['C6', 'FC3'], 'bad_by_manual': [], 'bad_all': ['F4', 'C6', 'PO3', 'C3', 'FC3']}
2026-01-12 14:15:55,638 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.65it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

2 by correlation: ['C3', 'F4']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.70it/s]

RANSAC done!
Detected bad channels: ['F4', 'PO3', 'C3', 'C6']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.2s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 60 PCA components
Blub ['F4', 'C6', 'PO3', 'C3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.67 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 030 - Perspective Cost SPN Amplitude: 1.362833541131607e-06
#######################################################################
start subject 031
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-031/eeg/sub-031_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-031/eeg/sub-031_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-031_task-regfront.

The search_str was "ds005841-download/sub-031/**/eeg/sub-031*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 158207  =      0.000 ...   308.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3840 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:07<00:00,    8.53it/s]
2026-01-12 14:16:37,734 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T7', 'TP7', 'T8'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['T7', 'TP7'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T8', 'T7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.61it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:16:45,127 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'AF7', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'AF7', 'FT8', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
2026-01-12 14:16:45,343 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.55it/s]
2026-01-12 14:16:52,503 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'FT7', 'AF7', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'FT7', 'AF7', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
2026-01-12 14:16:52,674 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.54it/s]

RANSAC done!
2026-01-12 14:16:59,876 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'FT7', 'AF7', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'FT7', 'AF7', 'FT8', 'P8']}
2026-01-12 14:16:59,876 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.51it/s]

RANSAC done!
Found 9 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

9 by correlation: ['AF7', 'F5', 'F7', 'T7', 'TP7', 'AF4', 'FT8', 'T8', 'P8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    8.85it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'AF7', 'FT8', 'P8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 55 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 4.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 6 ICA components
    Projecting back using 55 PCA components
Blub ['TP7', 'T7', 'F5', 'F7', 'AF4', 'T8', 'AF7', 'FT8', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['C3']
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.06 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-031/eeg/sub-031_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-031/eeg/sub-031_task-regperp_events.tsv.
Reading 0 ... 168959  =      0.000 ...   329.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-031_task-regperp.

The search_str was "ds005841-download/sub-031/**/eeg/sub-031*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
130 events found on stim channel Status
Event IDs: [    5     6     7     8    56 65536]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
130 events found on stim channel Status
Event IDs: [    5     6     7     8    56 65536]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4160 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.58it/s]
2026-01-12 14:17:35,373 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['C5', 'T7', 'TP7', 'T8'], 'bad_by_correlation': ['T7'], 'bad_by_SNR': ['T7'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'T8', 'C5']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,   10.09it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:17:43,600 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P8'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:17:43,745 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.73it/s]
2026-01-12 14:17:51,890 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['T7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P8'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:17:52,126 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.72it/s]
2026-01-12 14:18:00,696 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['T7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P8'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8', 'P8']}
2026-01-12 14:18:00,697 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.50it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['T7']

6 by correlation: ['Fp1', 'AF7', 'T7', 'TP7', 'FT8', 'T8']

1 by SNR: ['T7']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:07<00:00,    8.37it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 58 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 7.0s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 58 PCA components
Blub ['TP7', 'T7', 'T8', 'Fp1', 'AF7', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['C3']
    Rejecting  epoch based on EEG : ['C3']
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.11 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 031 - Perspective Cost SPN Amplitude: -9.54698759737427e-07
#######################################################################
start subject 032
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-032/eeg/sub-032_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-032/eeg/sub-032_task-regfront_events.tsv.
Reading 0 ... 156671  =      0.000 ...   305.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-032_task-regfront.

The search_str was "ds005841-download/sub-032/**/eeg/sub-032*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3840 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.71it/s]
2026-01-12 14:18:44,676 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'P1', 'Fp2', 'AF8'], 'bad_by_correlation': ['CP3', 'P1', 'P2'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'P1', 'CP3', 'P2', 'AF8', 'Fp2']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.44it/s]
2026-01-12 14:18:52,115 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:18:52,304 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   11.27it/s]
2026-01-12 14:18:59,056 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:18:59,164 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.64it/s]

RANSAC done!
2026-01-12 14:19:06,374 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8']}
2026-01-12 14:19:06,374 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:05<00:00,   10.30it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['Fp2']

0 by HF noise: []

6 by correlation: ['F5', 'FT7', 'CP3', 'Fp2', 'AF8', 'FT8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.00it/s]

RANSAC done!
Detected bad channels: ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.1s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 57 PCA components
Blub ['F5', 'FT7', 'CP3', 'P1', 'AF8', 'Fp2', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.97 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-032/eeg/sub-032_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-032/eeg/sub-032_task-regperp_events.tsv.
Reading 0 ... 168959  =      0.000 ...   329.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-032_task-regperp.

The search_str was "ds005841-download/sub-032/**/eeg/sub-032*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4160 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,   10.17it/s]

RANSAC done!
2026-01-12 14:19:41,575 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'P1', 'Fp2', 'AF8', 'FT8', 'FC2'], 'bad_by_correlation': ['P1', 'Pz', 'P2'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'P1', 'AF7', 'FC2', 'P2', 'Pz', 'AF8', 'Fp2', 'FT8']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.93it/s]
2026-01-12 14:19:49,765 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P1', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:19:49,946 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.82it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:19:57,966 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'P1', 'AF7', 'AF8', 'Fp2', 'FT8'], 'bad_by_correlation': ['P1', 'FT8'], 'bad_by_SNR': ['P1', 'FT8'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'P1', 'AF7', 'AF8', 'Fp2', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:19:58,111 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.87it/s]
2026-01-12 14:20:06,134 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'P1', 'AF7', 'FC2', 'AF8', 'Fp2', 'FT8'], 'bad_by_correlation': ['P1', 'FT8'], 'bad_by_SNR': ['P1', 'FT8'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'P1', 'AF7', 'FC2', 'AF8', 'Fp2', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:20:06,306 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.97it/s]
2026-01-12 14:20:14,253 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'P1', 'AF7', 'FC2', 'AF8', 'Fp2', 'FT8'], 'bad_by_correlation': ['P1', 'FT8'], 'bad_by_SNR': ['P1', 'FT8'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'P1', 'AF7', 'FC2', 'AF8', 'Fp2', 'FT8']}
2026-01-12 14:20:14,253 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.95it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

6 by HF noise: ['Fp1', 'AF7', 'Fp2', 'AF8', 'FT8', 'FC2']

1 by correlation: ['FT8']

1 by SNR: ['FT8']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:07<00:00,    8.99it/s]

RANSAC done!
Detected bad channels: ['Fp1', 'P1', 'AF7', 'FC2', 'AF8', 'Fp2', 'FT8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.7s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 57 PCA components
Blub ['Fp1', 'P1', 'AF7', 'FC2', 'AF8', 'Fp2', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['F8']
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.80 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 032 - Perspective Cost SPN Amplitude: 8.345903885314281e-07
#######################################################################
start subject 033
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-033/eeg/sub-033_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-033/eeg/sub-033_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-033_task-regfront.

The search_str was "ds005841-download/sub-033/**/eeg/sub-033*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 167935  =      0.000 ...   327.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4096 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.97it/s]
2026-01-12 14:20:56,581 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['PO3', 'POz'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'AF7', 'PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.97it/s]
2026-01-12 14:21:04,726 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF7', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF7', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:21:04,858 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,   10.03it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:21:12,739 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['FT8', 'AF7', 'PO3'], 'bad_by_SNR': ['AF7', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FT8', 'AF7', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:21:12,912 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:05<00:00,   11.00it/s]
2026-01-12 14:21:20,225 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['FT8', 'AF7', 'PO3'], 'bad_by_SNR': ['AF7', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['FT8', 'AF7', 'PO3']}
2026-01-12 14:21:20,225 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:06<00:00,    9.98it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['AF7']

2 by correlation: ['AF7', 'FT8']

1 by SNR: ['AF7']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 65/65 [00:07<00:00,    8.93it/s]

RANSAC done!
Detected bad channels: ['FT8', 'AF7', 'PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 61 PCA components
Blub ['FT8', 'AF7', 'PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.20 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-033/eeg/sub-033_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-033/eeg/sub-033_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-033_task-regperp.

The search_str was "ds005841-download/sub-033/**/eeg/sub-033*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 153599  =      0.000 ...   299.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3776 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.13it/s]

RANSAC done!
2026-01-12 14:21:56,104 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['PO3', 'O1', 'POz'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['Oz'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'AF7', 'Oz', 'O1']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,    9.99it/s]
2026-01-12 14:22:03,519 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8'], 'bad_by_manual': [], 'bad_all': ['FT8', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:22:03,656 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,    9.94it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:22:10,907 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['FT8', 'PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8'], 'bad_by_manual': [], 'bad_all': ['FT8', 'AF7', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:22:11,073 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,    9.94it/s]

RANSAC done!
2026-01-12 14:22:18,321 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['FT8', 'PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT8'], 'bad_by_manual': [], 'bad_all': ['FT8', 'AF7', 'PO3']}
2026-01-12 14:22:18,321 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.71it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['AF7', 'AF8']

1 by correlation: ['FT8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.05it/s]

RANSAC done!
Detected bad channels: ['AF8', 'FT8', 'AF7', 'PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.7s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 60 PCA components
Blub ['AF8', 'FT8', 'AF7', 'PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['Iz']
    Rejecting  epoch based on EEG : ['Iz']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['Iz']
    Rejecting  epoch based on EEG : ['Iz']
    Rejecting  epoch based on EEG : ['Iz']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.09 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 033 - Perspective Cost SPN Amplitude: -1.1779576227637567e-07
#######################################################################
start subject 034
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-034/eeg/sub-034_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-034/eeg/sub-034_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-034_task-regfront.

The search_str was "ds005841-download/sub-034/**/eeg/sub-034*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 165375  =      0.000 ...   322.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.91it/s]
2026-01-12 14:22:58,318 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P4'], 'bad_by_manual': [], 'bad_all': ['POz', 'P4']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.91it/s]
2026-01-12 14:23:07,101 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': []}

RANSAC done!
2026-01-12 14:23:07,149 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.98it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:23:14,968 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:23:15,134 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.98it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:23:23,637 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'T7', 'F5', 'C3', 'C5'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'POz', 'T7', 'F5', 'C3', 'C5']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:23:23,784 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.59it/s]

RANSAC done!
2026-01-12 14:23:32,668 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'T7', 'F5', 'C3', 'C5'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'POz', 'T7', 'F5', 'C3', 'C5']}
2026-01-12 14:23:32,668 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.45it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

5 by HF noise: ['F5', 'C3', 'C5', 'T7', 'TP7']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.55it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T7', 'F5', 'C3', 'C5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.1s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 59 PCA components
Blub ['TP7', 'T7', 'F5', 'C3', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.55 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-034/eeg/sub-034_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-034/eeg/sub-034_task-regperp_events.tsv.
Reading 0 ... 176639  =      0.000 ...   344.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-034_task-regperp.

The search_str was "ds005841-download/sub-034/**/eeg/sub-034*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4352 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.71it/s]
2026-01-12 14:24:11,781 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F1', 'POz', 'P4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P4', 'F1']}

RANSAC done!
  0%|          |  : 0/68 [00:00<?,       ?it/s]Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.80it/s]
2026-01-12 14:24:20,757 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fp2', 'FC4', 'F1'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'FC4', 'F1']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:24:20,980 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.85it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:24:30,028 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'FC4', 'F1', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'FC4', 'F1', 'Fp2', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:24:30,329 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.80it/s]

RANSAC done!
2026-01-12 14:24:38,890 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'FC4', 'F1', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'FC4', 'F1', 'Fp2', 'FT8']}
2026-01-12 14:24:38,890 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.82it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

3 by correlation: ['F1', 'FT8', 'FC4']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.57it/s]

RANSAC done!
Detected bad channels: ['FT8', 'FC4', 'F1']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.7s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 61 PCA components
Blub ['FT8', 'FC4', 'F1']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.60 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 034 - Perspective Cost SPN Amplitude: 2.048702350852977e-06
#######################################################################
start subject 035
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-035/eeg/sub-035_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-035/eeg/sub-035_task-regfront_events.tsv.
Reading 0 ... 186879  =      0.000 ...   364.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-035_task-regfront.

The search_str was "ds005841-download/sub-035/**/eeg/sub-035*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4608 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.48it/s]
2026-01-12 14:25:19,747 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['PO7', 'Iz'], 'bad_by_manual': [], 'bad_all': ['Iz', 'PO3', 'PO7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.47it/s]

RANSAC done!
2026-01-12 14:25:29,900 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP8']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:25:30,216 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.48it/s]
2026-01-12 14:25:40,006 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:25:40,521 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:07<00:00,    9.59it/s]

RANSAC done!
2026-01-12 14:25:49,883 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP8']}
2026-01-12 14:25:49,883 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:06<00:00,   10.50it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

1 by correlation: ['TP8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 72/72 [00:08<00:00,    8.53it/s]

RANSAC done!
Detected bad channels: ['TP8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 63 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 6.1s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 63 PCA components
Blub ['TP8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.59 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-035/eeg/sub-035_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-035/eeg/sub-035_task-regperp_events.tsv.
Reading 0 ... 202239  =      0.000 ...   394.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-035_task-regperp.

The search_str was "ds005841-download/sub-035/**/eeg/sub-035*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4992 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.50it/s]
2026-01-12 14:26:33,289 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO7', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz', 'TP8'], 'bad_by_manual': [], 'bad_all': ['TP8', 'Iz', 'PO3', 'PO7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:08<00:00,    9.73it/s]

RANSAC done!
2026-01-12 14:26:44,304 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'TP8', 'C6', 'CP4'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'TP8', 'C6', 'CP4']}
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:26:44,815 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.01it/s]
2026-01-12 14:26:54,682 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'C6', 'F8', 'CP4', 'AF8', 'TP8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'C6', 'F8', 'TP8', 'CP4', 'AF8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:26:55,085 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.16it/s]
2026-01-12 14:27:04,751 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'C6', 'F8', 'TP8', 'CP4', 'AF8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'C6', 'F8', 'CP4', 'AF8', 'TP8']}
2026-01-12 14:27:04,751 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:07<00:00,   10.01it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

5 by correlation: ['TP7', 'AF8', 'F8', 'TP8', 'CP4']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 78/78 [00:09<00:00,    8.53it/s]

RANSAC done!
Detected bad channels: ['TP7', 'F8', 'CP4', 'AF8', 'TP8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 59 PCA components
Blub ['TP7', 'F8', 'TP8', 'CP4', 'AF8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.11 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 035 - Perspective Cost SPN Amplitude: -4.848489371831691e-07
#######################################################################
start subject 036
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-036/eeg/sub-036_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-036/eeg/sub-036_task-regfront_events.tsv.
Reading 0 ... 160767  =      0.000 ...   313.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-036_task-regfront.

The search_str was "ds005841-download/sub-036/**/eeg/sub-036*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3904 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.48it/s]
2026-01-12 14:27:52,516 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp2', 'TP8'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3'], 'bad_by_manual': [], 'bad_all': ['POz', 'TP8', 'Fp2', 'PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.97it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:28:00,348 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:28:00,514 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,   10.27it/s]
2026-01-12 14:28:07,989 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T7', 'AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:28:08,212 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   10.47it/s]

RANSAC done!
2026-01-12 14:28:15,547 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T7', 'AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8']}
2026-01-12 14:28:15,547 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.97it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

6 by correlation: ['Fp2', 'AF8', 'AF4', 'FT8', 'T8', 'TP8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.66it/s]

RANSAC done!
Detected bad channels: ['AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8', 'T7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 4.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 57 PCA components
Blub ['T7', 'AF4', 'T8', 'TP8', 'AF8', 'Fp2', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.54 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-036/eeg/sub-036_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-036/eeg/sub-036_task-regperp_events.tsv.
Reading 0 ... 181759  =      0.000 ...   354.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-036_task-regperp.

The search_str was "ds005841-download/sub-036/**/eeg/sub-036*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4480 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.48it/s]
2026-01-12 14:28:52,511 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['O1', 'Oz', 'TP8', 'PO8', 'O2'], 'bad_by_correlation': ['P1', 'P5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3', 'POz'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'O2', 'P1', 'PO8', 'P5', 'TP8', 'Oz', 'O1']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:06<00:00,   10.31it/s]
2026-01-12 14:29:01,099 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T8', 'P10', 'TP8', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T8', 'P10', 'Iz', 'AF8', 'TP8', 'Fp2', 'FT8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 14:29:01,339 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:06<00:00,   10.05it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:29:09,908 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T8', 'P10', 'Iz', 'AF8', 'TP8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T8', 'Iz', 'P10', 'TP8', 'AF8', 'Fp2', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
2026-01-12 14:29:10,131 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:06<00:00,   10.33it/s]
2026-01-12 14:29:18,500 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP7', 'T8', 'Iz', 'P10', 'TP8', 'AF8', 'Fp2', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['Iz'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T8', 'Iz', 'P10', 'AF8', 'TP8', 'Fp2', 'FT8']}
2026-01-12 14:29:18,500 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 56 sensor positions
Interpolating 8 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:06<00:00,   11.43it/s]

RANSAC done!
Found 7 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

7 by correlation: ['TP7', 'Iz', 'AF8', 'FT8', 'T8', 'TP8', 'P10']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:08<00:00,    8.14it/s]

RANSAC done!
Detected bad channels: ['TP7', 'T8', 'Iz', 'P10', 'AF8', 'TP8', 'FT8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.6s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 6 ICA components
    Projecting back using 57 PCA components
Blub ['TP7', 'T8', 'Iz', 'P10', 'TP8', 'AF8', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.46 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 036 - Perspective Cost SPN Amplitude: -1.0837639989222443e-06
#######################################################################
start subject 037
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-037/eeg/sub-037_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-037/eeg/sub-037_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-037_task-regfront.

The search_str was "ds005841-download/sub-037/**/eeg/sub-037*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 170495  =      0.000 ...   332.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4160 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.59it/s]
2026-01-12 14:30:04,316 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3', 'Fpz', 'T8'], 'bad_by_correlation': ['PO3', 'Fpz'], 'bad_by_SNR': ['Fpz', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'Fpz', 'PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.72it/s]
2026-01-12 14:30:12,797 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fpz', 'PO3', 'FC6'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fpz', 'PO3', 'FC6']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:30:12,947 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,   10.77it/s]
2026-01-12 14:30:20,564 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz', 'FC6'], 'bad_by_correlation': ['Fpz', 'PO3', 'FC6'], 'bad_by_SNR': ['Fpz', 'FC6'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fpz', 'FC6', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:30:20,725 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.79it/s]

RANSAC done!
2026-01-12 14:30:28,931 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz', 'FC6'], 'bad_by_correlation': ['Fpz', 'PO3', 'FC6'], 'bad_by_SNR': ['Fpz', 'FC6'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fpz', 'FC6', 'PO3']}
2026-01-12 14:30:28,931 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.67it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['T7', 'FC6']

1 by correlation: ['FC6']

1 by SNR: ['FC6']

0 by dropout: []

1 by RANSAC: ['Fpz']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:07<00:00,    8.56it/s]

RANSAC done!
Detected bad channels: ['PO3', 'Fpz', 'FC6', 'T7', 'T8', 'FT7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 58 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.5s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 58 PCA components
Blub ['PO3', 'T7', 'T8', 'FC6', 'FT7', 'Fpz']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.04 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-037/eeg/sub-037_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-037/eeg/sub-037_task-regperp_events.tsv.
Reading 0 ... 175103  =      0.000 ...   341.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-037_task-regperp.

The search_str was "ds005841-download/sub-037/**/eeg/sub-037*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4288 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.54it/s]
2026-01-12 14:31:12,288 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT7', 'PO3', 'Fpz', 'T8'], 'bad_by_correlation': ['PO3', 'Fpz'], 'bad_by_SNR': ['Fpz', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'Fpz', 'PO3', 'FT7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.52it/s]
2026-01-12 14:31:21,188 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fpz', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fpz', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:31:21,343 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:05<00:00,   11.86it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:31:28,609 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz', 'FC6', 'FT7'], 'bad_by_correlation': ['Fpz', 'PO3', 'FC6'], 'bad_by_SNR': ['Fpz', 'FC6'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['Fpz', 'FC6', 'FT7', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:31:28,807 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:06<00:00,    9.83it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:31:37,270 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz', 'FC6', 'FT7', 'T7'], 'bad_by_correlation': ['Fpz', 'PO3', 'FC6'], 'bad_by_SNR': ['Fpz', 'FC6'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['PO3', 'T7', 'FC6', 'FT7', 'Fpz']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:31:37,413 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    9.58it/s]

RANSAC done!
2026-01-12 14:31:46,122 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz', 'FC6', 'FT7', 'T7'], 'bad_by_correlation': ['Fpz', 'PO3', 'FC6'], 'bad_by_SNR': ['Fpz', 'FC6'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['PO3', 'T7', 'FC6', 'FT7', 'Fpz']}
2026-01-12 14:31:46,122 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.60it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

3 by HF noise: ['FT7', 'T7', 'FC6']

0 by correlation: []

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['Fpz']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 68/68 [00:07<00:00,    8.72it/s]

RANSAC done!
Detected bad channels: ['PO3', 'T7', 'FC6', 'FT7', 'Fpz']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 8.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 59 PCA components
Blub ['PO3', 'T7', 'FC6', 'FT7', 'Fpz']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.84 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 037 - Perspective Cost SPN Amplitude: 7.98608128526087e-07
#######################################################################
start subject 038
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-038/eeg/sub-038_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-038/eeg/sub-038_task-regfront_events.tsv.
Reading 0 ... 172543  =      0.000 ...   336.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-038_task-regfront.

The search_str was "ds005841-download/sub-038/**/eeg/sub-038*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4224 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:06<00:00,    9.61it/s]

RANSAC done!
2026-01-12 14:32:33,995 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'PO3'], 'bad_by_correlation': ['P9', 'PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['P9', 'POz', 'AF7', 'PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:06<00:00,    9.88it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:32:42,528 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP8', 'P8', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP8', 'P8', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:32:42,755 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:06<00:00,    9.92it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
2026-01-12 14:32:51,007 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP8', 'P8', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP8', 'P8', 'PO3']}
Interpolating 3 sensors
2026-01-12 14:32:51,148 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:06<00:00,    9.90it/s]

RANSAC done!
2026-01-12 14:32:59,408 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['TP8', 'P8', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP8', 'P8', 'PO3']}
2026-01-12 14:32:59,408 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:07<00:00,    9.47it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['Fp1']

0 by HF noise: []

2 by correlation: ['TP8', 'P8']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 67/67 [00:07<00:00,    8.62it/s]

RANSAC done!
Detected bad channels: ['TP8', 'Fp1', 'P8', 'PO3', 'F7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 59 PCA components
Blub ['PO3', 'F7', 'Fp1', 'TP8', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.18 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-038/eeg/sub-038_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-038/eeg/sub-038_task-regperp_events.tsv.
Reading 0 ... 169471  =      0.000 ...   330.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-038_task-regperp.

The search_str was "ds005841-download/sub-038/**/eeg/sub-038*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4160 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.84it/s]
2026-01-12 14:33:42,565 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3'], 'bad_by_correlation': ['PO3', 'POz', 'P8'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P8', 'PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,   10.07it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:33:50,817 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'T8', 'TP8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3', 'T8', 'TP8', 'FT8', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:33:50,955 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,   10.05it/s]
2026-01-12 14:33:58,993 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'T8', 'FC6', 'TP8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3', 'T8', 'FC6', 'TP8', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 58 sensor positions
Interpolating 6 sensors
2026-01-12 14:33:59,159 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,    9.98it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:34:07,242 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'T8', 'FC6', 'TP8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F8'], 'bad_by_manual': [], 'bad_all': ['PO3', 'F8', 'T8', 'FC6', 'TP8', 'FT8', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
2026-01-12 14:34:07,365 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,   10.09it/s]
2026-01-12 14:34:15,357 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3', 'T8', 'FC6', 'TP8', 'FT8', 'P8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F8'], 'bad_by_manual': [], 'bad_all': ['PO3', 'F8', 'T8', 'FC6', 'TP8', 'FT8', 'P8']}
2026-01-12 14:34:15,357 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:06<00:00,   10.12it/s]

RANSAC done!
Found 6 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

5 by correlation: ['FT8', 'FC6', 'T8', 'TP8', 'P8']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['F8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 66/66 [00:07<00:00,    8.63it/s]

RANSAC done!
Detected bad channels: ['PO3', 'F8', 'T8', 'FC6', 'TP8', 'FT8', 'P8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 57 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 57 PCA components
Blub ['PO3', 'F8', 'T8', 'FC6', 'TP8', 'FT8', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 57 sensor positions
Interpolating 7 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['Fpz']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['PO8']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): 0.00 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 038 - Perspective Cost SPN Amplitude: -1.1838589577909828e-06
#######################################################################
start subject 040
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-040/eeg/sub-040_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-040/eeg/sub-040_task-regfront_events.tsv.
Reading 0 ... 165375  =      0.000 ...   322.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-040_task-regfront.

The search_str was "ds005841-download/sub-040/**/eeg/sub-040*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.76it/s]
2026-01-12 14:34:58,152 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz'], 'bad_by_correlation': ['P1', 'Fpz'], 'bad_by_SNR': ['Fpz'], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3'], 'bad_by_manual': [], 'bad_all': ['P1', 'Fpz', 'PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.80it/s]
2026-01-12 14:35:06,320 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fp2'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:35:06,493 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.54it/s]
2026-01-12 14:35:14,624 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fp2'], 'bad_by_hf_noise': ['Fpz'], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': ['Fpz'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:35:14,787 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.64it/s]
2026-01-12 14:35:22,846 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fp2'], 'bad_by_hf_noise': ['Fpz'], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': ['Fpz'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'Fp2']}
2026-01-12 14:35:22,846 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.78it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

2 by deviation: ['Fp1', 'Fp2']

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['Fpz']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.59it/s]

RANSAC done!
Detected bad channels: ['Fp1', 'Fpz', 'Fp2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 6.1s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 61 PCA components
Blub ['Fp1', 'Fpz', 'Fp2']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.55 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-040/eeg/sub-040_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-040/eeg/sub-040_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-040_task-regperp.

The search_str was "ds005841-download/sub-040/**/eeg/sub-040*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 156671  =      0.000 ...   305.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3840 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.88it/s]

RANSAC done!
2026-01-12 14:36:04,543 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fpz'], 'bad_by_correlation': ['P3', 'PO3', 'Fpz'], 'bad_by_SNR': ['Fpz'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fpz', 'PO3', 'P3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.75it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:36:12,350 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fp2'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'Fp2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:36:12,504 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.46it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:36:20,240 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fp2'], 'bad_by_hf_noise': ['Fpz', 'FT7'], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': ['Fpz'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'FT7', 'Fp2']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:36:20,383 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.61it/s]

RANSAC done!
2026-01-12 14:36:28,162 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fp2'], 'bad_by_hf_noise': ['Fpz', 'FT7'], 'bad_by_correlation': ['Fpz'], 'bad_by_SNR': ['Fpz'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'FT7', 'Fp2']}
2026-01-12 14:36:28,162 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:06<00:00,    9.75it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['Fp1']

1 by HF noise: ['FT7']

0 by correlation: []

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['Fpz']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 61/61 [00:07<00:00,    8.61it/s]

RANSAC done!
Detected bad channels: ['Fp1', 'Fpz', 'FT7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.1s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 61 PCA components
Blub ['Fp1', 'Fpz', 'FT7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.98 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 040 - Perspective Cost SPN Amplitude: 4.266720203016225e-07
#######################################################################
start subject 041
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-041/eeg/sub-041_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-041/eeg/sub-041_task-regfront_events.tsv.
Reading 0 ... 137727  =      0.000 ...   268.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-041_task-regfront.

The search_str was "ds005841-download/sub-041/**/eeg/sub-041*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
110 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
110 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3328 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:05<00:00,    9.56it/s]
2026-01-12 14:37:08,092 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'AF7', 'F3', 'F5', 'T7', 'Fp2', 'AF8', 'F6'], 'bad_by_correlation': ['POz'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['AF7', 'PO3'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'F3', 'T7', 'F5', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:05<00:00,   10.26it/s]
2026-01-12 14:37:14,653 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8', 'F5', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F7'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
2026-01-12 14:37:14,815 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:05<00:00,   10.29it/s]
2026-01-12 14:37:21,366 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['F5', 'AF8', 'AF7'], 'bad_by_hf_noise': ['AF7'], 'bad_by_correlation': ['T7', 'F8', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': ['AF7'], 'bad_by_dropout': [], 'bad_by_ransac': ['F7', 'Fpz'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'F6', 'Fp1', 'Fpz', 'AF7', 'AF8', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
2026-01-12 14:37:21,539 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:05<00:00,   10.57it/s]
2026-01-12 14:37:27,822 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8', 'F5', 'AF7'], 'bad_by_hf_noise': ['AF8', 'Fp1', 'AF7', 'Fp2'], 'bad_by_correlation': ['T7', 'F8', 'F6', 'FC6', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': ['AF8', 'Fp1', 'AF7', 'Fp2'], 'bad_by_dropout': [], 'bad_by_ransac': ['F7', 'Fpz'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'F6', 'FC6', 'Fp1', 'Fpz', 'AF7', 'AF8', 'Fp2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
2026-01-12 14:37:27,961 - pyprep.reference - INFO - Iterations: 3
  0%|          |  : 0/53 [00:00<?,       ?it/s]Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:04<00:00,   10.60it/s]
2026-01-12 14:37:34,253 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['F5', 'AF8', 'AF7'], 'bad_by_hf_noise': ['F5', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_correlation': ['T7', 'F8', 'FC6', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': ['AF8', 'Fp1', 'AF7', 'Fp2'], 'bad_by_dropout': [], 'bad_by_ransac': ['F7', 'Fpz'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'FC6', 'F6', 'Fp1', 'Fpz', 'AF7', 'AF8', 'Fp2']}
2026-01-12 14:37:34,253 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:05<00:00,   10.60it/s]

RANSAC done!
Found 9 uniquely bad channels:

0 by NaN: []

0 by flat: []

3 by deviation: ['AF7', 'F5', 'AF8']

5 by HF noise: ['Fp1', 'AF7', 'F5', 'Fp2', 'AF8']

8 by correlation: ['Fp1', 'AF7', 'T7', 'Fp2', 'AF8', 'F6', 'F8', 'FC6']

4 by SNR: ['AF8', 'Fp1', 'AF7', 'Fp2']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 53/53 [00:06<00:00,    8.51it/s]

RANSAC done!
Detected bad channels: ['T7', 'F8', 'F5', 'FC6', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 54 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 4.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 54 PCA components
Blub ['T7', 'F8', 'F5', 'F6', 'FC6', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
109 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 55 54
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -1.83 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-041/eeg/sub-041_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-041/eeg/sub-041_task-regperp_events.tsv.
Reading 0 ... 159743  =      0.000 ...   311.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-041_task-regperp.

The search_str was "ds005841-download/sub-041/**/eeg/sub-041*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3904 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:07<00:00,    8.40it/s]
2026-01-12 14:38:13,140 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'F5', 'AF8'], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['AF7', 'P9', 'PO3', 'AF8'], 'bad_by_manual': [], 'bad_all': ['PO3', 'F5', 'AF7', 'P9', 'AF8']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:04<00:00,   13.46it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:38:19,387 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8', 'F5', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P8'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 55 sensor positions
Interpolating 9 sensors
2026-01-12 14:38:19,619 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   10.36it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:38:27,258 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['F5', 'AF8', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P8'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
2026-01-12 14:38:27,432 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,   10.31it/s]
2026-01-12 14:38:34,870 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF8', 'F5', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['P8'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']}
2026-01-12 14:38:34,870 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   10.36it/s]

RANSAC done!
Found 10 uniquely bad channels:

0 by NaN: []

0 by flat: []

3 by deviation: ['AF7', 'F5', 'AF8']

0 by HF noise: []

7 by correlation: ['Fp1', 'AF7', 'F7', 'T7', 'Fp2', 'AF8', 'F8']

0 by SNR: []

0 by dropout: []

2 by RANSAC: ['F6', 'P8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:07<00:00,    8.47it/s]

RANSAC done!
Detected bad channels: ['T7', 'F8', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 54 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.9s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 54 PCA components
Blub ['T7', 'F8', 'F5', 'F7', 'F6', 'Fp1', 'AF7', 'AF8', 'Fp2', 'P8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 54 sensor positions
Interpolating 10 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.00 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 041 - Perspective Cost SPN Amplitude: 1.70889051515984e-07
#######################################################################
start subject 042
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-042/eeg/sub-042_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-042/eeg/sub-042_task-regfront_events.tsv.
Reading 0 ... 165375  =      0.000 ...   322.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-042_task-regfront.

The search_str was "ds005841-download/sub-042/**/eeg/sub-042*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.57it/s]

RANSAC done!
2026-01-12 14:39:17,478 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['POz', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'P2']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.84it/s]
2026-01-12 14:39:25,669 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fpz'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'P2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:39:25,841 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.85it/s]
2026-01-12 14:39:33,773 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fpz'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'P2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:39:33,949 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.67it/s]
2026-01-12 14:39:42,018 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1', 'Fpz'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1', 'Fpz', 'P2']}
2026-01-12 14:39:42,018 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.81it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

2 by deviation: ['Fp1', 'Fpz']

0 by HF noise: []

1 by correlation: ['P2']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.59it/s]

RANSAC done!
Detected bad channels: ['Fp1', 'Fpz', 'P2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.1s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 61 PCA components
Blub ['Fp1', 'Fpz', 'P2']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.63 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-042/eeg/sub-042_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-042/eeg/sub-042_task-regperp_events.tsv.
Reading 0 ... 159231  =      0.000 ...   310.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-042_task-regperp.

The search_str was "ds005841-download/sub-042/**/eeg/sub-042*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3904 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.51it/s]
2026-01-12 14:40:23,319 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['Fp1', 'P9'], 'bad_by_correlation': ['POz', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P2', 'Fp1', 'POz']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.58it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:40:31,398 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1'], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:40:31,596 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.52it/s]
2026-01-12 14:40:39,516 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1'], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:40:39,690 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.63it/s]
2026-01-12 14:40:47,522 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp1'], 'bad_by_hf_noise': [], 'bad_by_correlation': [], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp1']}
2026-01-12 14:40:47,523 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.67it/s]

RANSAC done!
Found 1 uniquely bad channels:

0 by NaN: []

0 by flat: []

1 by deviation: ['Fp1']

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:07<00:00,    8.53it/s]

RANSAC done!
Detected bad channels: ['Fp1']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 63 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.3s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 63 PCA components
Blub ['Fp1']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -2.92 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 042 - Perspective Cost SPN Amplitude: 2.2912675736312886e-06
#######################################################################
start subject 043
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-043/eeg/sub-043_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-043/eeg/sub-043_task-regfront_events.tsv.
Reading 0 ... 156159  =      0.000 ...   304.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-043_task-regfront.

The search_str was "ds005841-download/sub-043/**/eeg/sub-043*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3840 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:06<00:00,    9.60it/s]
2026-01-12 14:41:23,995 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3', 'F6'], 'bad_by_correlation': ['PO3', 'POz'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'F6', 'PO3']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:06<00:00,    9.98it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:41:31,597 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'FT8', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'FT8', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:41:31,803 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:06<00:00,    9.80it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:41:39,375 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT8', 'F6', 'PO3'], 'bad_by_correlation': ['PO3', 'T8', 'F6', 'FC6', 'FT8'], 'bad_by_SNR': ['FT8', 'F6', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['T8'], 'bad_by_manual': [], 'bad_all': ['PO3', 'T8', 'FC6', 'F6', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:41:39,573 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:05<00:00,   10.00it/s]

RANSAC done!
2026-01-12 14:41:46,960 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT8', 'F6', 'PO3'], 'bad_by_correlation': ['PO3', 'T8', 'F6', 'FC6', 'FT8'], 'bad_by_SNR': ['FT8', 'F6', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['T8'], 'bad_by_manual': [], 'bad_all': ['PO3', 'T8', 'FC6', 'F6', 'FT8']}
2026-01-12 14:41:46,960 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:06<00:00,    9.60it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['F6', 'FT8']

2 by correlation: ['F6', 'FT8']

2 by SNR: ['FT8', 'F6']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 60/60 [00:06<00:00,    8.61it/s]

RANSAC done!
Detected bad channels: ['FT8', 'F6', 'PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.2s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 61 PCA components
Blub ['FT8', 'F6', 'PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -4.64 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-043/eeg/sub-043_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-043/eeg/sub-043_task-regperp_events.tsv.
Reading 0 ... 152575  =      0.000 ...   297.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-043_task-regperp.

The search_str was "ds005841-download/sub-043/**/eeg/sub-043*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3712 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.62it/s]

RANSAC done!
2026-01-12 14:42:27,446 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['PO3', 'F6', 'FT8', 'T8'], 'bad_by_correlation': ['PO3', 'POz'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['POz', 'PO3', 'T8', 'F6', 'FT8']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,    9.84it/s]
2026-01-12 14:42:35,010 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8', 'FT8', 'PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'FT8', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:42:35,165 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.76it/s]
2026-01-12 14:42:42,585 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT8', 'F6', 'PO3'], 'bad_by_correlation': ['T8', 'FT8', 'PO3', 'F6'], 'bad_by_SNR': ['FT8', 'F6', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['T8', 'FT8', 'F6', 'PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:42:42,770 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.79it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:42:50,161 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT8', 'F6', 'PO3'], 'bad_by_correlation': ['T8', 'FT8', 'PO3', 'F6'], 'bad_by_SNR': ['FT8', 'F6', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['PO3', 'T8', 'F6', 'FT7', 'FT8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:42:50,376 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.75it/s]
2026-01-12 14:42:57,207 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT8', 'F6', 'PO3'], 'bad_by_correlation': ['T8', 'FT8', 'PO3', 'F6'], 'bad_by_SNR': ['FT8', 'F6', 'PO3'], 'bad_by_dropout': [], 'bad_by_ransac': ['FT7'], 'bad_by_manual': [], 'bad_all': ['PO3', 'T8', 'F6', 'FT7', 'FT8']}
2026-01-12 14:42:57,207 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.77it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

3 by HF noise: ['F6', 'FT8', 'T8']

3 by correlation: ['F6', 'FT8', 'T8']

3 by SNR: ['T8', 'FT8', 'F6']

0 by dropout: []

1 by RANSAC: ['FT7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.41it/s]

RANSAC done!
Detected bad channels: ['PO3', 'T8', 'F6', 'FT7', 'FT8', 'FT8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.0s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 59 PCA components
Blub ['PO3', 'T8', 'F6', 'FT7', 'FT8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.69 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 043 - Perspective Cost SPN Amplitude: -9.514857462796969e-07
#######################################################################
start subject 044
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-044/eeg/sub-044_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-044/eeg/sub-044_task-regfront_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-044_task-regfront.

The search_str was "ds005841-download/sub-044/**/eeg/sub-044*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 180735  =      0.000 ...   352.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4416 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.57it/s]
2026-01-12 14:43:38,575 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'T7', 'P1'], 'bad_by_correlation': ['P1'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P1', 'AF7', 'T7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.77it/s]
2026-01-12 14:43:47,653 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'AF7', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'P1', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:43:47,892 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:06<00:00,   11.08it/s]
2026-01-12 14:43:55,770 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'AF7', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'P1', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:43:55,968 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.80it/s]
2026-01-12 14:44:04,750 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'AF7', 'Fp2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'P1', 'AF7']}
2026-01-12 14:44:04,750 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:07<00:00,    9.61it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

2 by deviation: ['AF7', 'Fp2']

0 by HF noise: []

2 by correlation: ['AF7', 'Fp2']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 70/70 [00:08<00:00,    8.55it/s]

RANSAC done!
Detected bad channels: ['Fp2', 'P1', 'AF7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 5.7s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 61 PCA components
Blub ['Fp2', 'P1', 'AF7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.58 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-044/eeg/sub-044_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-044/eeg/sub-044_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-044_task-regperp.

The search_str was "ds005841-download/sub-044/**/eeg/sub-044*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 194047  =      0.000 ...   378.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4736 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.53it/s]
2026-01-12 14:44:51,673 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF7', 'T7', 'P1'], 'bad_by_correlation': ['P1'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P1', 'AF7', 'T7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.72it/s]
2026-01-12 14:45:02,088 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['AF7'], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P1', 'AF7'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P1', 'AF7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:45:02,470 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.82it/s]
2026-01-12 14:45:12,354 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'AF7'], 'bad_by_hf_noise': ['P1'], 'bad_by_correlation': ['P1', 'AF7', 'FT7', 'Fp2'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'P1', 'AF7', 'FT7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:45:12,852 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.86it/s]
2026-01-12 14:45:22,328 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': ['Fp2', 'AF7'], 'bad_by_hf_noise': ['P1'], 'bad_by_correlation': ['P1', 'AF7', 'FT7', 'Fp2'], 'bad_by_SNR': ['P1'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['Fp2', 'P1', 'AF7', 'FT7']}
2026-01-12 14:45:22,328 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:07<00:00,    9.49it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

2 by deviation: ['AF7', 'Fp2']

1 by HF noise: ['T7']

1 by correlation: ['AF7']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 75/75 [00:08<00:00,    8.74it/s]

RANSAC done!
Detected bad channels: ['Fp2', 'P1', 'AF7', 'T7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.2s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 60 PCA components
Blub ['Fp2', 'P1', 'AF7', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.96 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 044 - Perspective Cost SPN Amplitude: 3.8386414404614603e-07
#######################################################################
start subject 045
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-045/eeg/sub-045_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-045/eeg/sub-045_task-regfront_events.tsv.
Reading 0 ... 160255  =      0.000 ...   312.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-045_task-regfront.

The search_str was "ds005841-download/sub-045/**/eeg/sub-045*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3904 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.66it/s]

RANSAC done!
2026-01-12 14:46:07,613 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'PO3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.60it/s]
2026-01-12 14:46:15,682 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:46:15,892 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.65it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:46:23,677 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:46:23,861 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.61it/s]

RANSAC done!
2026-01-12 14:46:31,694 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'PO3'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'PO3']}
2026-01-12 14:46:31,694 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:07<00:00,    8.60it/s]

RANSAC done!
Found 2 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['TP7', 'TP8']

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:07<00:00,    8.49it/s]

RANSAC done!
Detected bad channels: ['TP7', 'TP8', 'PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.2s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 1 ICA component
    Projecting back using 61 PCA components
Blub ['TP7', 'TP8', 'PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.17 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-045/eeg/sub-045_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-045/eeg/sub-045_task-regperp_events.tsv.
Reading 0 ... 179199  =      0.000 ...   349.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-045_task-regperp.

The search_str was "ds005841-download/sub-045/**/eeg/sub-045*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4416 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.50it/s]

RANSAC done!
2026-01-12 14:47:10,462 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['TP7', 'PO3', 'O1'], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': ['PO3'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['TP7', 'PO3', 'O1']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.62it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:47:19,203 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:47:19,399 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.60it/s]
2026-01-12 14:47:28,132 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:47:28,281 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    9.67it/s]

RANSAC done!
2026-01-12 14:47:37,017 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['PO3'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['PO3']}
2026-01-12 14:47:37,017 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:07<00:00,    8.65it/s]

RANSAC done!
Found 0 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

0 by correlation: []

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 69/69 [00:08<00:00,    8.62it/s]

RANSAC done!
Detected bad channels: ['PO3']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 63 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.9s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 1 ICA component
    Projecting back using 63 PCA components
Blub ['PO3']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.38 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 045 - Perspective Cost SPN Amplitude: 2.038385239301801e-07
#######################################################################
start subject 046
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-046/eeg/sub-046_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-046/eeg/sub-046_task-regfront_events.tsv.
Reading 0 ... 163327  =      0.000 ...   318.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-046_task-regfront.

The search_str was "ds005841-download/sub-046/**/eeg/sub-046*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.85it/s]

RANSAC done!
2026-01-12 14:48:22,558 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['P9'], 'bad_by_correlation': ['P3', 'P9', 'P2', 'P10'], 'bad_by_SNR': ['P9'], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3'], 'bad_by_manual': [], 'bad_all': ['PO3', 'P10', 'P2', 'P9', 'P3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.66it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:48:30,733 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P10']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:48:30,889 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.60it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:48:38,875 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P10']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
2026-01-12 14:48:39,004 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.63it/s]

RANSAC done!
2026-01-12 14:48:47,010 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'P10'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P9', 'P10']}
2026-01-12 14:48:47,011 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 62 sensor positions
Interpolating 2 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

  0%|          |  : 0/63 [00:00<?,       ?it/s]Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.59it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

2 by correlation: ['P9', 'P10']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['T8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.65it/s]

RANSAC done!
Detected bad channels: ['P9', 'P10', 'T8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 6.0s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 61 PCA components
Blub ['P9', 'P10', 'T8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['CP6']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['CP6']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): 0.08 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-046/eeg/sub-046_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-046/eeg/sub-046_task-regperp_events.tsv.
Reading 0 ... 164351  =      0.000 ...   320.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-046_task-regperp.

The search_str was "ds005841-download/sub-046/**/eeg/sub-046*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 4032 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,    9.60it/s]

RANSAC done!
2026-01-12 14:49:29,907 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P3', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['PO3', 'POz', 'PO4'], 'bad_by_manual': [], 'bad_all': ['POz', 'PO4', 'PO3', 'P2', 'P3']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.02it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:49:37,978 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['F8', 'T8', 'CP6', 'P9', 'AF8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'T8', 'CP6', 'P9', 'AF8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:49:38,114 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.10it/s]
2026-01-12 14:49:45,907 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF8'], 'bad_by_correlation': ['F8', 'T8', 'CP6', 'P9', 'AF8'], 'bad_by_SNR': ['AF8'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'T8', 'CP6', 'P9', 'AF8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
2026-01-12 14:49:46,068 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.07it/s]

RANSAC done!
2026-01-12 14:49:53,869 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['AF8'], 'bad_by_correlation': ['F8', 'T8', 'CP6', 'P9', 'AF8'], 'bad_by_SNR': ['AF8'], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['F8', 'T8', 'CP6', 'P9', 'AF8']}
2026-01-12 14:49:53,869 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:06<00:00,   10.12it/s]

RANSAC done!
Found 5 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

1 by HF noise: ['AF8']

5 by correlation: ['P9', 'AF8', 'F8', 'T8', 'CP6']

1 by SNR: ['AF8']

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 64/64 [00:07<00:00,    8.84it/s]

RANSAC done!
Detected bad channels: ['F8', 'T8', 'CP6', 'P9', 'AF8']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 59 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.5s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 59 PCA components
Blub ['F8', 'T8', 'CP6', 'P9', 'AF8']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 59 sensor positions
Interpolating 5 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['P2']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['P2']
    Rejecting  epoch based on EEG : ['F6']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.89 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 046 - Perspective Cost SPN Amplitude: 9.631725049278625e-07
#######################################################################
start subject 047
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-047/eeg/sub-047_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-047/eeg/sub-047_task-regfront_events.tsv.
Reading 0 ... 160255  =      0.000 ...   312.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-047_task-regfront.

The search_str was "ds005841-download/sub-047/**/eeg/sub-047*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3904 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.87it/s]
2026-01-12 14:50:35,383 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['T7', 'Iz', 'TP8'], 'bad_by_manual': [], 'bad_all': ['TP8', 'T8', 'Iz', 'T7']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   11.08it/s]
2026-01-12 14:50:42,576 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'TP8', 'P9', 'AF8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'P8'], 'bad_by_manual': [], 'bad_all': ['TP7', 'AF8', 'T7', 'F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'P9', 'TP8', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
2026-01-12 14:50:42,756 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   10.85it/s]
2026-01-12 14:50:49,787 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'T7', 'F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'P9', 'TP8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'F5', 'P8', 'T7'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F8', 'F5', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'TP8', 'P9', 'AF8', 'FT8', 'P8']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
2026-01-12 14:50:49,965 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   11.12it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:50:56,897 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'TP8', 'Fp1', 'P9', 'AF8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'T7', 'F5', 'AF7', 'P8'], 'bad_by_manual': [], 'bad_all': ['TP7', 'AF8', 'T7', 'F8', 'F5', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'Fp1', 'AF7', 'P9', 'TP8', 'FT8', 'P8']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 48 sensor positions
Interpolating 16 sensors
2026-01-12 14:50:57,031 - pyprep.reference - INFO - Iterations: 3
  0%|          |  : 0/62 [00:00<?,       ?it/s]Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:04<00:00,   13.05it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:51:03,114 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'T7', 'F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'Fp1', 'P9', 'TP8', 'FT8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['TP7', 'T7', 'F5', 'AF7', 'P8'], 'bad_by_manual': [], 'bad_all': ['TP7', 'T7', 'F8', 'F5', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'TP8', 'Fp1', 'AF7', 'P9', 'AF8', 'FT8', 'P8']}
2026-01-12 14:51:03,114 - pyprep.reference - INFO - Robust reference done
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 48 sensor positions
Interpolating 16 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:05<00:00,   10.91it/s]

RANSAC done!
Found 11 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

10 by correlation: ['F7', 'FT7', 'P9', 'Iz', 'AF8', 'F8', 'FT8', 'T8', 'TP8', 'P10']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['P8']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 53 sensor positions
Interpolating 11 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 62/62 [00:06<00:00,    9.02it/s]

RANSAC done!
Detected bad channels: ['AF8', 'F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'P9', 'TP8', 'FT8', 'P8', 'C5']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 52 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.0s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 4 ICA components
    Projecting back using 52 PCA components
Blub ['F8', 'F7', 'Iz', 'T8', 'P10', 'FT7', 'TP8', 'P9', 'AF8', 'FT8', 'P8', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 52 sensor positions
Interpolating 12 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
    Rejecting  epoch based on EEG : ['P5', 'P10']
Applying baseline correction (mode: mean)
    Rejecting  epoch based on EEG : ['TP7', 'P9', 'PO7', 'Iz', 'T8', 'TP8', 'P8', 'P10', 'PO8', 'O2']
    Rejecting  epoch based on EEG : ['AF7', 'F7', 'FT7', 'T7']
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -0.09 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-047/eeg/sub-047_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-047/eeg/sub-047_task-regperp_events.tsv.
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-047_task-regperp.

The search_str was "ds005841-download/sub-047/**/eeg/sub-047*channels.tsv"
  raw = read_raw_bids(bids_path)
Reading 0 ... 152575  =      0.000 ...   297.998 secs...
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3712 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:06<00:00,    9.28it/s]
2026-01-12 14:51:42,842 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P9', 'T8'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['T7', 'PO7', 'TP8'], 'bad_by_manual': [], 'bad_all': ['PO7', 'T7', 'T8', 'P9', 'TP8']}

RANSAC done!
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.27it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:51:58,667 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'T8', 'FT7', 'CP5', 'TP8', 'Fp1', 'AF7', 'P9', 'AF8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC5'], 'bad_by_manual': [], 'bad_all': ['AF8', 'T7', 'F8', 'F7', 'T8', 'FT7', 'CP5', 'Fp1', 'AF7', 'FC5', 'P9', 'TP8', 'FT8', 'C5']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
2026-01-12 14:51:58,821 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.79it/s]
2026-01-12 14:52:05,812 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'T7', 'F8', 'F7', 'T8', 'FT7', 'CP5', 'Fp1', 'AF7', 'FC5', 'P9', 'TP8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['FC5'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F7', 'T8', 'FT7', 'CP5', 'TP8', 'Fp1', 'AF7', 'FC5', 'P9', 'AF8', 'FT8', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
2026-01-12 14:52:05,989 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   11.40it/s]
2026-01-12 14:52:12,481 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['T7', 'F8', 'F7', 'T8', 'FT7', 'CP5', 'TP8', 'Fp1', 'AF7', 'FC5', 'P9', 'AF8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F5', 'FC5'], 'bad_by_manual': [], 'bad_all': ['AF8', 'T7', 'F8', 'F5', 'F7', 'T8', 'FT7', 'CP5', 'Fp1', 'AF7', 'FC5', 'P9', 'TP8', 'FT8', 'C5']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 49 sensor positions
Interpolating 15 sensors
2026-01-12 14:52:12,617 - pyprep.reference - INFO - Iterations: 3
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.67it/s]

RANSAC done!
2026-01-12 14:52:19,745 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['AF8', 'T7', 'F8', 'F7', 'T8', 'FT7', 'CP5', 'Fp1', 'AF7', 'FC5', 'P9', 'TP8', 'FT8', 'C5'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['F5', 'FC5', 'T7'], 'bad_by_manual': [], 'bad_all': ['T7', 'F8', 'F5', 'F7', 'T8', 'FT7', 'CP5', 'TP8', 'Fp1', 'AF7', 'FC5', 'P9', 'AF8', 'FT8', 'C5']}
2026-01-12 14:52:19,745 - pyprep.reference - INFO - Robust reference done
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 49 sensor positions
Interpolating 15 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:05<00:00,   10.41it/s]

RANSAC done!
Found 13 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

0 by HF noise: []

12 by correlation: ['Fp1', 'AF7', 'F7', 'FT7', 'FC5', 'C5', 'P9', 'AF8', 'F8', 'FT8', 'T8', 'TP8']

0 by SNR: []

0 by dropout: []

1 by RANSAC: ['T7']

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 51 sensor positions
Interpolating 13 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 59/59 [00:07<00:00,    8.00it/s]

RANSAC done!
Detected bad channels: ['AF8', 'T7', 'F8', 'F7', 'T8', 'FT7', 'Fp1', 'FC5', 'AF7', 'P9', 'TP8', 'FT8', 'C5', 'PO7']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 50 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 6.0s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 1 ICA component
    Projecting back using 50 PCA components
Blub ['PO7', 'T7', 'F8', 'F7', 'T8', 'FT7', 'TP8', 'Fp1', 'FC5', 'AF7', 'P9', 'AF8', 'FT8', 'C5']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 50 sensor positions
Interpolating 14 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): -3.07 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 047 - Perspective Cost SPN Amplitude: 2.977446450225762e-06
#######################################################################
start subject 048
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-048/eeg/sub-048_task-regfront_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-048/eeg/sub-048_task-regfront_events.tsv.
Reading 0 ... 162303  =      0.000 ...   316.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-048_task-regfront.

The search_str was "ds005841-download/sub-048/**/eeg/sub-048*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 1  2  3  4 55]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.94it/s]

RANSAC done!
2026-01-12 14:53:04,906 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T7'], 'bad_by_correlation': ['PO3', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': ['POz'], 'bad_by_manual': [], 'bad_all': ['POz', 'P2', 'PO3', 'T7']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.91it/s]
2026-01-12 14:53:13,162 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:53:13,402 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.83it/s]
2026-01-12 14:53:21,207 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T8', 'FT7', 'T7'], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2', 'T8', 'FT7', 'T7']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
2026-01-12 14:53:21,471 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.84it/s]
2026-01-12 14:53:29,292 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T8', 'FT7', 'T7'], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2', 'T8', 'FT7', 'T7']}
2026-01-12 14:53:29,292 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.89it/s]

RANSAC done!
Found 4 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

3 by HF noise: ['FT7', 'T7', 'T8']

1 by correlation: ['P2']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.10it/s]

RANSAC done!
Detected bad channels: ['T7', 'T8', 'FT7', 'P2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 60 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
Fitting ICA took 5.4s.
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 3 ICA components
    Projecting back using 60 PCA components
Blub ['P2', 'T8', 'FT7', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 60 sensor positions
Interpolating 4 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): 1.02 µV
Extracting EDF parameters from /home/lisa/PycharmProjects/EEG_Project/ds005841-download/sub-048/eeg/sub-048_task-regperp_eeg.bdf...
BDF file detected
Setting channel info structure...
Creating raw.info structure...
Reading events from ds005841-download/sub-048/eeg/sub-048_task-regperp_events.tsv.
Reading 0 ... 161791  =      0.000 ...   315.998 secs...
/home/lisa/PycharmProjects/EEG_Project/s_00_fetch_data.py:18: RuntimeWarning: Did not find any channels.tsv associated with sub-048_task-regperp.

The search_str was "ds005841-download/sub-048/**/eeg/sub-048*channels.tsv"
  raw = read_raw_bids(bids_path)
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Finding events on: Status
Trigger channel Status has a non-zero initial value of 65536 (consider using initial_event=True to detect this event)
Removing orphaned offset at the beginning of the file.
129 events found on stim channel Status
Event IDs: [ 5  6  7  8 56]
Original sampling frequency: 512.0 Hz
Resampled frequency: 256.0 Hz
Filtering raw data in 1 contiguous segment
Setting up band-pass filter from 0.1 - 40 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 0.10
- Lower transition bandwidth: 0.10 Hz (-6 dB cutoff frequency: 0.05 Hz)
- Upper passband edge: 40.00 Hz
- Upper transition bandwidth: 10.00 Hz (-6 dB cutoff frequency: 45.00 Hz)
- Filter length: 8449 samples (33.004 s)

Filtering raw data in 1 contiguous segment
Setting up band-stop filter from 49 - 51 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal bandstop filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 49.38
- Lower transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 49.12 Hz)
- Upper passband edge: 50.62 Hz
- Upper transition bandwidth: 0.50 Hz (-6 dB cutoff frequency: 50.88 Hz)
- Filter length: 1691 samples (6.605 s)

Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
Effective window size : 8.000 (s)
/home/lisa/PycharmProjects/EEG_Project/s_03_data_annotation.py:12: RuntimeWarning: The unit for channel(s) EXG1, EXG2, EXG3, EXG4, EXG5, EXG6, EXG7, EXG8 has changed from V to NA.
  raw.set_channel_types({ch: 'misc' for ch in exg_chs})
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Removed notch frequencies (Hz):
     50.00 : 3968 windows
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.84it/s]

RANSAC done!
2026-01-12 14:54:09,842 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['T7'], 'bad_by_correlation': ['PO3', 'P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2', 'PO3', 'T7']}
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.85it/s]
2026-01-12 14:54:18,006 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': [], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2']}

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 63 sensor positions
Interpolating 1 sensors
2026-01-12 14:54:18,195 - pyprep.reference - INFO - Iterations: 1
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.85it/s]

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
2026-01-12 14:54:25,972 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT7', 'T7'], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2', 'FT7', 'T7']}
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
2026-01-12 14:54:26,147 - pyprep.reference - INFO - Iterations: 2
Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,   10.04it/s]
2026-01-12 14:54:33,795 - pyprep.reference - INFO - Bad channels: {'bad_by_nan': [], 'bad_by_flat': [], 'bad_by_deviation': [], 'bad_by_hf_noise': ['FT7', 'T7'], 'bad_by_correlation': ['P2'], 'bad_by_SNR': [], 'bad_by_dropout': [], 'bad_by_ransac': [], 'bad_by_manual': [], 'bad_all': ['P2', 'FT7', 'T7']}
2026-01-12 14:54:33,795 - pyprep.reference - INFO - Robust reference done

RANSAC done!
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:06<00:00,    9.90it/s]

RANSAC done!
Found 3 uniquely bad channels:

0 by NaN: []

0 by flat: []

0 by deviation: []

2 by HF noise: ['FT7', 'T7']

1 by correlation: ['P2']

0 by SNR: []

0 by dropout: []

0 by RANSAC: []

0 by manual: []

Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Executing RANSAC
This may take a while, so be patient...
100%|██████████|  : 63/63 [00:07<00:00,    8.26it/s]

RANSAC done!
Detected bad channels: ['T7', 'FT7', 'P2']
EEG channel type selected for re-referencing
Applying average reference.
Applying a custom ('EEG',) reference.
Filtering raw data in 1 contiguous segment
Setting up high-pass filter at 1 Hz

FIR filter parameters
---------------------
Designing a one-pass, zero-phase, non-causal highpass filter:
- Windowed time-domain design (firwin) method
- Hamming window with 0.0194 passband ripple and 53 dB stopband attenuation
- Lower passband edge: 1.00
- Lower transition bandwidth: 1.00 Hz (-6 dB cutoff frequency: 0.50 Hz)
- Filter length: 845 samples (3.301 s)

Fitting ICA to data using 61 channels (please be patient, this may take a while)
Selecting by number: 20 components
Computing Infomax ICA
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided Raw instance is not filtered between 1 and 100 Hz. ICLabel was designed to classify features extracted from an EEG dataset bandpass filtered between 1 and 100 Hz (see the 'filter()' method for Raw and Epochs instances).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
/home/lisa/PycharmProjects/EEG_Project/s_05_ica.py:40: RuntimeWarning: The provided ICA instance was fitted with a 'infomax' algorithm. ICLabel was designed with extended infomax ICA decompositions. To use the extended infomax algorithm, use the 'mne.preprocessing.ICA' instance with the arguments 'ICA(method='infomax', fit_params=dict(extended=True))' (scikit-learn) or 'ICA(method='picard', fit_params=dict(ortho=False, extended=True))' (python-picard).
  labels = label_components(raw, ica, method='iclabel') # probabilities per IC and category
Fitting ICA took 11.3s.
Applying ICA to Raw instance
    Transforming to ICA space (20 components)
    Zeroing out 2 ICA components
    Projecting back using 61 PCA components
Blub ['P2', 'FT7', 'T7']
Setting channel interpolation method to {'eeg': 'spline'}.
Interpolating bad channels.
    Automatic origin fit: head of radius 96.3 mm
Computing interpolation matrix from 61 sensor positions
Interpolating 3 sensors
Used Annotations descriptions: ['ASYM', 'SYM']
Not setting metadata
128 matching events found
Setting baseline interval to [-0.19921875, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Amount of epochs: 64 64
Applying baseline correction (mode: mean)
Applying baseline correction (mode: mean)
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
SPN Amplitude (0.3s to 0.6s): 0.19 µV
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
Subject 048 - Perspective Cost SPN Amplitude: 8.308915948233488e-07

Computing grand averages...
Identifying common channels ...
Identifying common channels ...
Identifying common channels ...
Identifying common channels ...
Identifying common channels ...
Identifying common channels ...
Identifying common channels ...

Grand-average Perspective Cost Amplitude: 0.19 µV
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
combining channels using "mean"
combining channels using "mean"
combining channels using "mean"

Process finished with exit code 0
